<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kap.service.dao.cm.CommonMapper">

    <!--
    쿼리명 : MPAUserMapper.selectDupEmail
    설  명 : 이메일 중복 검사
      수정일      수정자       수정내용
    ==========   ========   ==============
    2023.11.10    양현우       최초생성
-->
    <select id="selectDupEmail" parameterType="MPAUserDto" resultType="java.lang.Integer">
        select count(*)
            from co_mem_mst
              where mem_seq not in(#{detailsKey})
               and email=#{email}
    </select>

    <!--
    쿼리명 : CommonMapper.selectDupEmail
    설  명 :  시퀀스 조회
      수정일      수정자       수정내용
    ==========   ========   ==============
    2023.11.10    양현우       최초생성
-->
    <select id="selectSeqNum" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT /* SMDAPsnIfMapper.selectSeqNum */
            NEXT_ID
        FROM CO_SEQ_MST
        WHERE TABLE_NM = #{tableNm}
    </select>

    <!--
쿼리명 : CommonMapper.updateSeq
설  명 :  시퀀스 증가
  수정일      수정자       수정내용
==========   ========   ==============
2023.11.10    양현우       최초생성
-->
    <update id="updateSeq" parameterType="java.lang.String">
        UPDATE /* CommonMapper.updateSeq */ CO_SEQ_MST
        SET
            NEXT_ID = NEXT_ID + 1
        WHERE
            TABLE_NM = #{tableNm}
    </update>

    <!--
쿼리명 : CommonMapper.selectMemEmail
설  명 : 회원 이메일 , 코드 검색
수정일      수정자       수정내용
==========   ========   ==============
2023.11.15    양현우       최초생성
-->
    <select id="selectMemDtl" parameterType="MPPwdInitDto" resultType="MPPwdInitDto">
        SELECT /* CommonMapper.selectMemDtl */
             email
           , mem_cd
          from co_mem_mst
              where id =#{id}
    </select>


    <!--
쿼리명 : CommonMapper.updatePwdInit
설  명 : 회원 비밀번호 초기화
수정일      수정자       수정내용
==========   ========   ==============
2023.11.15    양현우       최초생성
-->
    <update id="updatePwdInit" parameterType="MPPwdInitDto">
        update co_mem_mst
         set pwd = #{newEncPwd}
           , pwd_chng_dtm = now()
           , lgn_fail_cnt = 0
           , mod_id = #{modId}
           , mod_ip = #{modIp}
           , mod_dtm = now()
            where id =#{id}

    </update>

</mapper>