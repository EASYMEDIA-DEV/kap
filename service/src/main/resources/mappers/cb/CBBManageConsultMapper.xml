<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kap.service.dao.cb.cbb.CBBManageConsultMapper">
    <!--
        쿼리명 : CBBManageConsultMapper.selectManageConsultList
        설  명 : 목록 조회
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.11.21    이옥정       최초생성
    -->
    <select id="selectManageConsultList" parameterType="CBBManageConsultSearchDTO" resultType="CBBManageConsultListDTO">
        SELECT /* CBBManageConsultMapper.selectManageConsultList */
            CNSTG_SEQ					/* 컨설팅순번 */
            , CNSTG_CD                  /* 컨설팅코드 */
            , BSN_YEAR					/* 사엽연도 */
            , RSUME_STTS_CD			    /* 진행상태코드 */
            , RSUME_STTS_NM			/* 진행상태코드명 */
            , CMPN_NM					/* 부품사명 */
            , CTGRY_CD					/* 부품사구분코드 */
            , CTGRY_NM					/* 부품사구분코드명 */
            , SIZE_CD					/* 부품사규모코드 */
            , SIZE_NM					/* 부품사큐모코드명 */
            , APPCTN_BSNM_NO			/* 신청당시 사업자번호 */
            , SLS_PMT					/* 매출액(억원) */
            , MPLE_CNT					/* 부품사 직원수 */
            , APPCTN_FLD_CD				/* 신청분야 코드 */
            , APPCTN_FLD_NM				/* 신청분야 코드명 */
            , FIRST_RGNS_CD			    /* 첫번째 지역 코드 */
            , FIRST_RGNS_NM			    /* 첫번째 지역 코드명 */
            , SCND_RGNS_CD				/* 두번째 지역 코드 */
            , SCND_RGNS_NM				/* 첫번째 지역 코드명 */
            , CRTFN_CMPN_NM			    /* SQ 인증 주관사 */
            , MN_CMPN_NM				/* 주고객사 */
            , VST_DT					/* 방문일 */
            , CMSSR_SEQ					/* 위원순번 */
            , CMSSR_NM					/* 위원이름 */
            , CMSSR_CBSN_CD			    /* 담당위원지도분야 코드 */
            , CMSSR_CBSN_NM			    /* 담당위원지도분야 코드명 */
            , CNSTG_KICKF_DT			/* 킥오프시작일 */
            , KICKF_FILE_SEQ			/* 킥오프파일순번 */
            , KICKF_FILE_ORD            /* 킥오프파일ORD */
            , CNSTG_PSCND_CD			/* 컨설팅현황코드 */
            , CNSTG_PSCND_NM			/* 컨설팅현황코드명 */
            , CNSTG_PSCND_DT			/* 컨설팅현황일자 */
            , LVLUP_DT					/* 렙업일자 */
            , LVLUP_FILE_SEQ			/* 렙업파일순번 */
            , LVLUP_FILE_ORD			/* 렙업파일ORD */
            , APPCTN_DT					/* 신청일 */
            , REG_ID					/* 등록자ID */
            , REG_NAME					/* 등록자이름 */
            , REG_DTM					/* 등록일 */
            , MOD_ID					/* 수정자ID */
            , MOD_NAME					/* 수정자이름 */
            , MOD_DTM					/* 수정일 */
            , MJR_PRDCT_1               /* 주생산품1 */
            , MJR_PRDCT_2               /* 주생산품2 */
            , MJR_PRDCT_3               /* 주생산품3 */
        FROM(
            SELECT
                CP_MST.CNSTG_SEQ
                , CP_MST.CNSTG_CD
                , CP_MST.BSN_YEAR
                , CMPN_MST.CMPN_NM
                , CMPN_MST.CTGRY_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CMPN_MST.CTGRY_CD AND CD_ID = 'COMPANY_TYPE') CTGRY_NM
                , CMPN_MST.SIZE_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CMPN_MST.SIZE_CD AND CD_ID = 'COMPANY_TYPE') SIZE_NM
                , CP_MST.APPCTN_BSNM_NO
                , CMPN_MST.SLS_PMT
                , CMPN_MST.MPLE_CNT
                , CP_MST.APPCTN_FLD_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.APPCTN_FLD_CD AND CD_ID = 'MNGCNSLT_APP_AREA') APPCTN_FLD_NM
                , CP_MST.FIRST_RGNS_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.FIRST_RGNS_CD AND CD_ID = 'ADDR_CD') FIRST_RGNS_NM
                , CP_MST.SCND_RGNS_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.SCND_RGNS_CD AND CD_ID = 'ADDR_CD') SCND_RGNS_NM
                , (SELECT CRTFN_CMPN_NM FROM CP_CMPN_CBSN_DTL CMPNDTL WHERE BSNM_NO = CP_MST.APPCTN_BSNM_NO ORDER BY CMPNDTL.YEAR DESC, CMPNDTL.REG_DTM DESC LIMIT 1) CRTFN_CMPN_NM
                , (SELECT CMPN_NM FROM CP_CNSTG_DLVRY_DTL WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ ORDER BY RATE DESC LIMIT 1) MN_CMPN_NM
                , CPR_MST.VST_DT
                , CPR_MST.CMSSR_SEQ
                , (SELECT NAME FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ)) CMSSR_NM
                , (SELECT CMSSR_CBSN_CD FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ)) CMSSR_CBSN_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD_ID = 'MEM_CD' AND CD = (SELECT CMSSR_CBSN_CD FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ))) CMSSR_CBSN_NM
                , CPR_MST.CNSTG_KICKF_DT
                , CPR_MST.KICKF_FILE_SEQ
                , (SELECT FILE_ORD FROM CO_FILE_DTL WHERE FILE_SEQ = CPR_MST.KICKF_FILE_SEQ AND USE_YN = 'Y') KICKF_FILE_ORD
                , CPR_MST.CNSTG_PSCND_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CPR_MST.CNSTG_PSCND_CD AND CD_ID = 'CNSTG_PSCND') CNSTG_PSCND_NM
                , CPR_MST.CNSTG_PSCND_DT
                , (SELECT CNSTG_KICKF_DT FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ AND CNSTG_PSCND_CD = 'CNSTG_PSCND03') LVLUP_DT
                , CPR_MST.LVLUP_FILE_SEQ
                , (SELECT FILE_ORD FROM CO_FILE_DTL WHERE FILE_SEQ = CPR_MST.LVLUP_FILE_SEQ AND USE_YN = 'Y') LVLUP_FILE_ORD
                , CP_MST.APPCTN_DT
                , CP_MST.RSUME_STTS_CD
                , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.RSUME_STTS_CD AND CD_ID = 'MNGCNSLT_STATUS') RSUME_STTS_NM
                , CP_MST.REG_ID
                , (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = CP_MST.APPCTN_MEM_SEQ) REG_NAME
                , CP_MST.REG_DTM
                , CPR_MST.MOD_ID
                , (SELECT NAME FROM CO_ADM_MST WHERE ID = CPR_MST.MOD_ID) MOD_NAME
                , CPR_MST.MOD_DTM
                , CMPN_MST.MJR_PRDCT_1
                , CMPN_MST.MJR_PRDCT_2
                , CMPN_MST.MJR_PRDCT_3
            FROM
                CP_CNSTG_APPCTN_MST CP_MST
            JOIN CO_MEM_MST MEM_MST
            ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
                LEFT JOIN CP_CMPN_MST CMPN_MST
                    ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
                LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
                    ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
            ) MST
        <include refid="selectManageConsultListWhereSql" />
        ORDER BY
            REG_DTM DESC
        LIMIT #{firstIndex}, #{recordCountPerPage}
    </select>

    <!--
    쿼리명 : CBBManageConsultMapper.selectTechGuidanceSurvey
    설  명 :  컨설팅 기술 관리 만족도 결과
    수정일     수정자       수정내용
    ==========   ======    ==============
    2023.12.15   임서화      최초 생성
-->
    <select id="selectTechGuidanceSurvey"  parameterType="java.lang.Integer" resultType="CBBConsultSuveyRsltListDTO">
        SELECT /* CBBManageConsultMapper.selectTechGuidanceSurvey */
            PTCPT_NAME,
            PTCPT_TELNO,
            PTCPT_PSTN,
            TTL_SCORE,
            GUIDE_RSLT_SCORE,
            MND_SCORE,
            CMMNCTN_SCORE,
            PLNNGABLT_SCORE,
            EXCTVABLT_SCORE,
            EXPRTS_SCORE
        FROM
            CP_CNSTG_SRV_RSLT_DTL
        WHERE
            CNSTG_SEQ = #{detailsKey}
    </select>

    <!--
        쿼리명 : CBBManageConsultMapper.getManageConsultListCnt
        설  명 : 목록 전체 갯수
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.11.24    이옥정       최초생성
    -->
    <select id="getManageConsultListCnt" parameterType="CBBManageConsultSearchDTO" resultType="java.lang.Integer">
        SELECT /* CBBManageConsultMapper.getManageConsultListCnt */
        COUNT(*)
        FROM(
            SELECT
            CNSTG_SEQ /* 컨설팅순번 */
            , CNSTG_CD /* 컨설팅코드 */
            , BSN_YEAR /* 사엽연도 */
            , RSUME_STTS_CD /* 진행상태코드 */
            , RSUME_STTS_NM /* 진행상태코드명 */
            , CMPN_NM /* 부품사명 */
            , CTGRY_CD /* 부품사구분코드 */
            , CTGRY_NM /* 부품사구분코드명 */
            , SIZE_CD /* 부품사규모코드 */
            , SIZE_NM /* 부품사큐모코드명 */
            , APPCTN_BSNM_NO /* 신청당시 사업자번호 */
            , SLS_PMT /* 매출액(억원) */
            , MPLE_CNT /* 부품사 직원수 */
            , APPCTN_FLD_CD /* 신청분야 코드 */
            , APPCTN_FLD_NM /* 신청분야 코드명 */
            , FIRST_RGNS_CD /* 첫번째 지역 코드 */
            , FIRST_RGNS_NM /* 첫번째 지역 코드명 */
            , SCND_RGNS_CD /* 두번째 지역 코드 */
            , SCND_RGNS_NM /* 첫번째 지역 코드명 */
            , CRTFN_CMPN_NM /* SQ 인증 주관사 */
            , MN_CMPN_NM /* 주고객사 */
            , VST_DT /* 방문일 */
            , CMSSR_SEQ /* 위원순번 */
            , CMSSR_NM /* 위원이름 */
            , CMSSR_CBSN_CD /* 담당위원지도분야 코드 */
            , CMSSR_CBSN_NM /* 담당위원지도분야 코드명 */
            , CNSTG_KICKF_DT /* 킥오프시작일 */
            , KICKF_FILE_SEQ /* 킥오프파일순번 */
            , KICKF_FILE_ORD /* 킥오프파일ORD */
            , CNSTG_PSCND_CD /* 컨설팅현황코드 */
            , CNSTG_PSCND_NM /* 컨설팅현황코드명 */
            , CNSTG_PSCND_DT /* 컨설팅현황일자 */
            , LVLUP_DT /* 렙업일자 */
            , LVLUP_FILE_SEQ /* 렙업파일순번 */
            , LVLUP_FILE_ORD /* 렙업파일ORD */
            , APPCTN_DT /* 신청일 */
            , REG_ID /* 등록자ID */
            , REG_NAME /* 등록자이름 */
            , REG_DTM /* 등록일 */
            , MOD_ID /* 수정자ID */
            , MOD_NAME /* 수정자이름 */
            , MOD_DTM /* 수정일 */
            , MJR_PRDCT_1 /* 주생산품1 */
            , MJR_PRDCT_2 /* 주생산품2 */
            , MJR_PRDCT_3 /* 주생산품3 */
            FROM(
            SELECT
            CP_MST.CNSTG_SEQ
            , CP_MST.CNSTG_CD
            , CP_MST.BSN_YEAR
            , CMPN_MST.CMPN_NM
            , CMPN_MST.CTGRY_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CMPN_MST.CTGRY_CD AND CD_ID = 'COMPANY_TYPE') CTGRY_NM
            , CMPN_MST.SIZE_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CMPN_MST.SIZE_CD AND CD_ID = 'COMPANY_TYPE') SIZE_NM
            , CP_MST.APPCTN_BSNM_NO
            , CMPN_MST.SLS_PMT
            , CMPN_MST.MPLE_CNT
            , CP_MST.APPCTN_FLD_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.APPCTN_FLD_CD AND CD_ID = 'MNGCNSLT_APP_AREA') APPCTN_FLD_NM
            , CP_MST.FIRST_RGNS_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.FIRST_RGNS_CD AND CD_ID = 'ADDR_CD') FIRST_RGNS_NM
            , CP_MST.SCND_RGNS_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.SCND_RGNS_CD AND CD_ID = 'ADDR_CD') SCND_RGNS_NM
            , (SELECT CRTFN_CMPN_NM FROM CP_CMPN_CBSN_DTL CMPNDTL WHERE BSNM_NO = CP_MST.APPCTN_BSNM_NO ORDER BY
            CMPNDTL.YEAR DESC, CMPNDTL.REG_DTM DESC LIMIT 1) CRTFN_CMPN_NM
            , (SELECT CMPN_NM FROM CP_CNSTG_DLVRY_DTL WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ ORDER BY RATE DESC LIMIT 1)
            MN_CMPN_NM
            , CPR_MST.VST_DT
            , CPR_MST.CMSSR_SEQ
            , (SELECT NAME FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE
            CNSTG_SEQ = CP_MST.CNSTG_SEQ)) CMSSR_NM
            , (SELECT CMSSR_CBSN_CD FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM
            CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ)) CMSSR_CBSN_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD_ID = 'MEM_CD' AND CD = (SELECT CMSSR_CBSN_CD FROM CO_MEM_MST WHERE
            MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ)))
            CMSSR_CBSN_NM
            , CPR_MST.CNSTG_KICKF_DT
            , CPR_MST.KICKF_FILE_SEQ
            , (SELECT FILE_ORD FROM CO_FILE_DTL WHERE FILE_SEQ = CPR_MST.KICKF_FILE_SEQ AND USE_YN = 'Y') KICKF_FILE_ORD
            , CPR_MST.CNSTG_PSCND_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CPR_MST.CNSTG_PSCND_CD AND CD_ID = 'CNSTG_PSCND') CNSTG_PSCND_NM
            , CPR_MST.CNSTG_PSCND_DT
            , (SELECT CNSTG_KICKF_DT FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ AND CNSTG_PSCND_CD =
            'CNSTG_PSCND03') LVLUP_DT
            , CPR_MST.LVLUP_FILE_SEQ
            , (SELECT FILE_ORD FROM CO_FILE_DTL WHERE FILE_SEQ = CPR_MST.LVLUP_FILE_SEQ AND USE_YN = 'Y') LVLUP_FILE_ORD
            , CP_MST.APPCTN_DT
            , CP_MST.RSUME_STTS_CD
            , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.RSUME_STTS_CD AND CD_ID = 'MNGCNSLT_STATUS') RSUME_STTS_NM
            , CP_MST.REG_ID
            , (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = CP_MST.APPCTN_MEM_SEQ) REG_NAME
            , CP_MST.REG_DTM
            , CPR_MST.MOD_ID
            , (SELECT NAME FROM CO_ADM_MST WHERE ID = CPR_MST.MOD_ID) MOD_NAME
            , CPR_MST.MOD_DTM
            , CMPN_MST.MJR_PRDCT_1
            , CMPN_MST.MJR_PRDCT_2
            , CMPN_MST.MJR_PRDCT_3
            FROM
            CP_CNSTG_APPCTN_MST CP_MST
            JOIN CO_MEM_MST MEM_MST
            ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
            LEFT JOIN CP_CMPN_MST CMPN_MST
            ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
            LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
            ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
            ) MST
            <include refid="selectManageConsultListWhereSql"/>
        ) A
    </select>

    <!--
        쿼리명 : selectManageConsultListWhereSql
        설  명 : 목록 조건
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.11.24    이옥정       최초생성
    -->
    <sql id="selectManageConsultListWhereSql">
        <where>
            AND CNSTG_CD = 'CONSULT_GB02'
            <!--기간검색 -->
            <if test="strtDt != null and strtDt != ''.toString() ">
                <choose>
                    <when test="srchDate == 1">
                        AND APPCTN_DT <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                    <when test="srchDate == 2">
                        AND VST_DT <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                    <when test="srchDate == 3">
                        AND CNSTG_KICKF_DT <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                    <when test="srchDate == 4">
                        AND LVLUP_DT <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                    <when test="srchDate == 5">
                        AND REG_DTM <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                    <when test="srchDate == 6">
                        AND MOD_DTM <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                    </when>
                </choose>
            </if>
            <if test="endDt != null and endDt != ''.toString() ">
                <choose>
                    <when test="srchDate == 1">
                        AND APPCTN_DT <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                    <when test="srchDate == 2">
                        AND VST_DT <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                    <when test="srchDate == 3">
                        AND CNSTG_KICKF_DT <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                    <when test="srchDate == 4">
                        AND LVLUP_DT <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                    <when test="srchDate == 5">
                        AND REG_DTM <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                    <when test="srchDate == 6">
                        AND MOD_DTM <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{endDt}, '%Y-%m-%d'), interval 1 day)
                    </when>
                </choose>
            </if>
            <!-- 구분 -->
            <if test="ctgryCdList != null and ctgryCdList.size() > 0">
                AND
                <foreach collection="ctgryCdList" item="list" index="index" open="(" close=")" separator=" or ">
                    CTGRY_CD = #{list}
                </foreach>
            </if>
            <!-- 지도분야 -->
            <if test="appctnFidCd != null and appctnFidCd != ''">
                AND APPCTN_FLD_CD = #{appctnFidCd}
            </if>
            <!-- 진행상태 -->
            <if test="rsumeSttsCd != null and rsumeSttsCd != ''">
                AND RSUME_STTS_CD = #{rsumeSttsCd}
            </if>
            <if test="q != null and q != ''.toString() ">
                <choose>
                    <when test="f == 1">
                        <!-- 부품사명 -->
                        AND EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND CMPN_NM LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 2 ">
                        <!-- 사업자등록번호 -->
                        AND EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND BSNM_NO LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 3 ">
                        <!-- 매출액 -->
                        AND EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND SLS_PMT LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 4 ">
                        <!-- 직원수 -->
                        AND EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND MPLE_CNT LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 5 ">
                        <!-- 신청소재지 -->
                        AND EXISTS(SELECT CNSTG_SEQ FROM CP_CNSTG_APPCTN_MST WHERE CNSTG_SEQ = MST.CNSTG_SEQ and ( FIRST_RGNS_NM LIKE CONCAT('%', #{q}, '%') OR SCND_RGNS_NM LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <when test="f == 6 ">
                        <!-- SQ인증주관사 -->
                        AND EXISTS(SELECT CNSTG_SEQ FROM CP_CNSTG_APPCTN_MST WHERE CNSTG_SEQ = MST.CNSTG_SEQ AND CRTFN_CMPN_NM LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 7 ">
                        <!-- 담당위원 -->
                        AND EXISTS(SELECT MEM_SEQ FROM CO_MEM_MST WHERE MEM_SEQ = MST.CMSSR_SEQ AND NAME LIKE CONCAT('%', #{q}, '%'))
                    </when>
                    <when test="f == 8 ">
                        <!-- 최초등록자 -->
                        AND (
                        INSTR(#{q}, MST.REG_ID) <![CDATA[>]]> 0
                        OR EXISTS(SELECT MEM_SEQ FROM CO_ADM_MST WHERE ID = MST.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        OR EXISTS(SELECT MEM_SEQ FROM CO_MEM_MST WHERE ID = MST.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        )
                    </when>
                    <when test="f == 9 ">
                        <!-- 최종등록자 -->
                        AND (
                        INSTR(#{q}, aa.MOD_ID) <![CDATA[>]]> 0
                        OR EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = AA.MOD_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        )
                    </when>
                    <otherwise>
                        AND (
                        EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND CMPN_NM LIKE CONCAT('%', #{q}, '%'))
                        OR EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND BSNM_NO LIKE CONCAT('%', #{q}, '%'))
                        OR EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND SLS_PMT LIKE CONCAT('%', #{q}, '%'))
                        OR EXISTS(SELECT BSNM_NO FROM CP_CMPN_MST WHERE BSNM_NO = MST.APPCTN_BSNM_NO AND MPLE_CNT LIKE CONCAT('%', #{q}, '%'))
                        OR EXISTS(SELECT CNSTG_SEQ FROM CP_CNSTG_APPCTN_MST WHERE CNSTG_SEQ = MST.CNSTG_SEQ and ( FIRST_RGNS_NM LIKE CONCAT('%', #{q}, '%') OR SCND_RGNS_NM LIKE CONCAT('%', #{q}, '%')))
                        OR EXISTS(SELECT CNSTG_SEQ FROM CP_CNSTG_APPCTN_MST WHERE CNSTG_SEQ = MST.CNSTG_SEQ AND CRTFN_CMPN_NM LIKE CONCAT('%', #{q}, '%'))
                        OR EXISTS(SELECT MEM_SEQ FROM CO_MEM_MST WHERE MEM_SEQ = MST.CMSSR_SEQ AND NAME LIKE CONCAT('%', #{q}, '%'))
                        OR INSTR(#{q}, MST.REG_ID) <![CDATA[>]]> 0
                        OR EXISTS(SELECT ADM_SEQ FROM CO_ADM_MST WHERE ID = MST.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        OR EXISTS(SELECT MEM_SEQ FROM CO_MEM_MST WHERE ID = MST.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        OR INSTR(#{q}, MST.MOD_ID) <![CDATA[>]]> 0
                        OR EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = MST.MOD_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)
                        )
                    </otherwise>
                </choose>
            </if>
        </where>
    </sql>

    <!--
        쿼리명 : CBBManageConsultMapper.selectConsultSuveyRsltList
        설  명 : 만족도 종합결과 리스트 조회
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.12.04    이옥정       최초생성
    -->
    <select id="selectConsultSuveyRsltList" parameterType="CBBConsultSuveyRsltListDTO" resultType="CBBConsultSuveyRsltListDTO">
        SELECT
            BSN_YEAR                                                                           <!-- 사업연도 -->
            , COUNT(APPCTN_BSNM_NO) CMPN_CNT                                                   <!-- 대상부품사 -->
            , SUM(SRV_CMPLT_CMPN_CNT) SRV_CMPLT_CMPN_CNT                                       <!-- 설문완료 부품사 -->
            , SUM(RGLR_CMPN_CNT) RGLR_CMPN_CNT                                                 <!-- 정규 부품사 -->
            , SUM(SHRT_CMPN_CNT) SHRT_CMPN_CNT                                                 <!-- 단기 부품사 -->
            , SUM(CMSSR_CNT) CMSSR_CNT                                                         <!-- 위원 -->
            , IFNULL(ROUND((SUM(TTL_SCORE) / SUM(SRV_CMPLT_CMPN_CNT)),1),0) TTL_AVG_SCORE      <!-- 총합점수평균 -->
            , IFNULL(ROUND((SUM(RGLR_SCORE) / SUM(RGLR_CMPN_CNT)),1),0) RGLR_AVG_SCORE         <!-- 정규점수평균 -->
            , IFNULL(ROUND((SUM(SHRT_SCORE) / SUM(SHRT_CMPN_CNT)),1),0) SHRT_AVG_SCORE         <!-- 단기점수평균 -->
        FROM (
            SELECT
                CP_MST.BSN_YEAR
                , CP_MST.APPCTN_BSNM_NO
                , (SELECT COUNT(TTL_SCORE) FROM CP_CNSTG_SRV_RSLT_DTL CCSR WHERE CP_MST.CNSTG_SEQ = CCSR.CNSTG_SEQ ) SRV_CMPLT_CMPN_CNT
                , (SELECT COUNT(*) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD01' ) SHRT_CMPN_CNT
                , (SELECT COUNT(*) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD02' ) RGLR_CMPN_CNT
                , (SELECT COUNT(CMSSR_SEQ) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ ) CMSSR_CNT
                , CPSR.TTL_SCORE
                , (SELECT TTL_SCORE FROM CP_CNSTG_SRV_RSLT_DTL WHERE CNSTG_SEQ = (SELECT CNSTG_SEQ FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD01' )) SHRT_SCORE
                , (SELECT TTL_SCORE FROM CP_CNSTG_SRV_RSLT_DTL WHERE CNSTG_SEQ = (SELECT CNSTG_SEQ FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD02' )) RGLR_SCORE
            FROM
                CP_CNSTG_APPCTN_MST CP_MST
            JOIN CO_MEM_MST MEM_MST
            ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
                LEFT JOIN CP_CMPN_MST CMPN_MST
                    ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
                LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
                    ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
                LEFT JOIN CP_CNSTG_SRV_RSLT_DTL CPSR
                    ON CP_MST.CNSTG_SEQ = CPSR.CNSTG_SEQ
            WHERE 1=1
                <if test="rtnBsnGubun != null and rtnBsnGubun != ''">
                    AND CP_MST.CNSTG_CD = '${rtnBsnGubun}'
                </if>
                AND CPR_MST.BFRE_JDGMT_RSLT_CD = 'BF_JDGMT_RSLT01'
                AND CPR_MST.INIT_VST_RSLT_CD = 'INIT_VST_RSLT01'
                AND CPR_MST.CNSTG_PSCND_CD = 'CNSTG_PSCND03'
                AND GUIDE_PSCND_CD = 'GUIDE_PSCND04'
        ) MST
        <if test="rtnBsnYear != null and rtnBsnYear != ''">
        WHERE
            BSN_YEAR = ${rtnBsnYear}
        </if>
        GROUP BY
            MST.BSN_YEAR
        ORDER BY
            MST.BSN_YEAR DESC
        LIMIT #{firstIndex}, #{recordCountPerPage}
    </select>

    <!--
        쿼리명 : CBBManageConsultMapper.getManageConsultListCnt
        설  명 : 만족도 종합결과 목록 전체 갯수
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.12.04    이옥정       최초생성
    -->
    <select id="getConsultSuveyRsltCnt" parameterType="CBBConsultSuveyRsltListDTO" resultType="java.lang.Integer">
        SELECT
            COUNT(*)
        FROM(
            SELECT
                BSN_YEAR
            FROM (
                SELECT
                    CP_MST.BSN_YEAR
                    , CP_MST.APPCTN_BSNM_NO
                    , (SELECT COUNT(TTL_SCORE) FROM CP_CNSTG_SRV_RSLT_DTL CCSR WHERE CP_MST.CNSTG_SEQ = CCSR.CNSTG_SEQ ) SRV_CMPLT_CMPN_CNT
                    , (SELECT COUNT(*) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD01' ) SHRT_CMPN_CNT
                    , (SELECT COUNT(*) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD02' ) RGLR_CMPN_CNT
                    , (SELECT COUNT(CMSSR_SEQ) FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ ) CMSSR_CNT
                    , CPSR.TTL_SCORE
                    , (SELECT TTL_SCORE FROM CP_CNSTG_SRV_RSLT_DTL WHERE CNSTG_SEQ = (SELECT CNSTG_SEQ FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD01' )) SHRT_SCORE
                    , (SELECT TTL_SCORE FROM CP_CNSTG_SRV_RSLT_DTL WHERE CNSTG_SEQ = (SELECT CNSTG_SEQ FROM CP_CNSTG_RSUME_MST CCR WHERE CP_MST.CNSTG_SEQ = CCR.CNSTG_SEQ AND CCR.GUIDE_TYPE_CD = 'GUIDE_TYPE_CD02' )) RGLR_SCORE
                FROM
                    CP_CNSTG_APPCTN_MST CP_MST
                JOIN CO_MEM_MST MEM_MST
                ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
                    LEFT JOIN CP_CMPN_MST CMPN_MST
                        ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
                    LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
                        ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
                    LEFT JOIN CP_CNSTG_SRV_RSLT_DTL CPSR
                        ON CP_MST.CNSTG_SEQ = CPSR.CNSTG_SEQ
                WHERE 1=1
                <if test="rtnBsnGubun != null and rtnBsnGubun != ''">
                    AND CP_MST.CNSTG_CD = '${rtnBsnGubun}'
                </if>
                    AND CP_MST.CNSTG_CD = 'CONSULT_GB02'
                    AND CPR_MST.BFRE_JDGMT_RSLT_CD = 'BF_JDGMT_RSLT01'
                    AND CPR_MST.INIT_VST_RSLT_CD = 'INIT_VST_RSLT01'
                    AND CPR_MST.CNSTG_PSCND_CD = 'CNSTG_PSCND03'
                    AND GUIDE_PSCND_CD = 'GUIDE_PSCND04'
            ) MST
        GROUP BY MST.BSN_YEAR
        ) AA
    </select>

    <!--
        쿼리명 : CBBManageConsultMapper.selectConsultSuveyRsltDtlExcel
        설  명 : 만족도 종합결과 엑셀다운 상세 조회
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.12.04    이옥정       최초생성
    -->
    <select id="selectConsultSuveyRsltDtlExcel" parameterType="CBBConsultSuveyRsltListDTO" resultType="CBBConsultSuveyRsltListDTO">
        SELECT
        CP_MST.BSN_YEAR             <!-- 사업연도 -->
        , CMPN_MST.CMPN_NM          <!-- 부품사명 -->
        , (SELECT NAME FROM CO_MEM_MST WHERE MEM_CD = 'CS' AND MEM_SEQ = (SELECT CMSSR_SEQ FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ)) CMSSR_NM    <!-- 담당위원 -->
        , CPSR.PTCPT_NAME           <!-- 참여자 -->
        , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CP_MST.APPCTN_FLD_CD AND CD_ID = 'MNGCNSLT_APP_AREA') APPCTN_FLD_NM     <!-- 신청업종/분야 -->
        , (SELECT CD_NM FROM CO_CODE_MST WHERE CD = CPR_MST.GUIDE_TYPE_CD AND CD_ID = 'GUIDE_TYPE_CD') GUIDE_TYPE_NM        <!-- 지도구분 -->
        , CASE IFNULL(CPSR.TTL_SCORE, 0) WHEN 0 THEN '미참여' ELSE '참여' END AS SRV_STTS                                     <!-- 설문참여상태 -->
        , (SELECT CNSTG_KICKF_DT FROM CP_CNSTG_RSUME_MST WHERE CNSTG_SEQ = CP_MST.CNSTG_SEQ AND CNSTG_PSCND_CD = 'CNSTG_PSCND03') LVLUP_DT      <!-- 렙업일 -->
        , IFNULL(CPSR.TTL_SCORE, 0) TTL_SCORE                       <!-- 총점(100) -->
        , IFNULL(CPSR.GUIDE_RSLT_SCORE, 0) GUIDE_RSLT_SCORE         <!-- 지도실적(50) -->
        , IFNULL(CPSR.CMMNCTN_SCORE, 0) CMMNCTN_SCORE               <!-- 의사소동(5) -->
        , IFNULL(CPSR.PLNNGABLT_SCORE, 0) PLNNGABLT_SCORE           <!-- 기획력(10) -->
        , IFNULL(CPSR.EXCTVABLT_SCORE, 0) EXCTVABLT_SCORE           <!-- 실행력(15) -->
        , IFNULL(CPSR.MND_SCORE, 0) MND_SCORE                       <!-- 마인드(5) -->
        , IFNULL(CPSR.EXPRTS_SCORE, 0) EXPRTS_SCORE                 <!-- 전문지식(15) -->
        FROM
        CP_CNSTG_APPCTN_MST CP_MST
        JOIN CO_MEM_MST MEM_MST
        ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
        LEFT JOIN CP_CMPN_MST CMPN_MST
        ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
        LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
        ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
        LEFT JOIN CP_CNSTG_SRV_RSLT_DTL CPSR
        ON CP_MST.CNSTG_SEQ = CPSR.CNSTG_SEQ
        where 1=1
        <if test="rtnBsnYear != null and rtnBsnYear != ''">
            AND BSN_YEAR = ${rtnBsnYear}
        </if>
        AND CPR_MST.BFRE_JDGMT_RSLT_CD = 'BF_JDGMT_RSLT01'
        AND CPR_MST.INIT_VST_RSLT_CD = 'INIT_VST_RSLT01'
        AND CPR_MST.CNSTG_PSCND_CD = 'CNSTG_PSCND03'
        AND GUIDE_PSCND_CD = 'GUIDE_PSCND04'
        ORDER BY
        CP_MST.REGDTM DESC
        LIMIT #{firstIndex}, #{recordCountPerPage}
    </select>

    <!--
        쿼리명 : CBBManageConsultMapper.getConsultSuveyRsltDtlCnt
        설  명 : 만족도 종합결과 엑셀 상세 전체 갯수
          수정일      수정자       수정내용
        ==========   ========   ==============
        2023.12.04    이옥정       최초생성
    -->
    <select id="getConsultSuveyRsltDtlCnt" parameterType="CBBConsultSuveyRsltListDTO" resultType="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM
        CP_CNSTG_APPCTN_MST CP_MST
        JOIN CO_MEM_MST MEM_MST
        ON MEM_MST.MEM_SEQ = CP_MST.APPCTN_MEM_SEQ
        LEFT JOIN CP_CMPN_MST CMPN_MST
        ON CMPN_MST.BSNM_NO = CP_MST.APPCTN_BSNM_NO
        LEFT JOIN CP_CNSTG_RSUME_MST CPR_MST
        ON CP_MST.CNSTG_SEQ = CPR_MST.CNSTG_SEQ
        LEFT JOIN CP_CNSTG_SRV_RSLT_DTL CPSR
        ON CP_MST.CNSTG_SEQ = CPSR.CNSTG_SEQ
        where 1=1
        <if test="rtnBsnYear != null and rtnBsnYear != ''">
            AND BSN_YEAR = ${rtnBsnYear}
        </if>
        AND CPR_MST.BFRE_JDGMT_RSLT_CD = 'BF_JDGMT_RSLT01'
        AND CPR_MST.INIT_VST_RSLT_CD = 'INIT_VST_RSLT01'
        AND CPR_MST.CNSTG_PSCND_CD = 'CNSTG_PSCND03'
        AND GUIDE_PSCND_CD = 'GUIDE_PSCND04'
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgDlvryInfo
     설  명 :  고객사 비율 상세 조회
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectCnstgDlvryInfo" parameterType="java.lang.Integer" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectCnstgDlvryInfo */
            CNSTG_SEQ,
            CMPN_DLVRY_SEQ,
            CMPN_NM AS DLVRY_CMPN_NM,
            RATE AS DLVRY_RATE
        FROM
            CP_CNSTG_DLVRY_DTL
        WHERE
            CNSTG_SEQ =  #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.insertCnstgDlvryInfo
     설  명 :  고객사 비율 비율 등록
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <insert id="insertCnstgDlvryInfo" parameterType="java.util.HashMap">
        INSERT /* CBBManageConsultMapper.insertCnstgDlvryInfo */ INTO CP_CNSTG_DLVRY_DTL(
          CNSTG_SEQ
        , CMPN_DLVRY_SEQ
        , CMPN_NM
        , RATE
        , REG_ID
        , REG_IP
        , REG_DTM
        )
        VALUES(
          #{cnstgSeq}
          , #{cmpnDlvrySeq}
          , #{dlvryCmpnNm}
          , #{dlvryRate}
          , #{regId}
          , #{regIp}
          , now()
          )
    </insert>

    <!--
     쿼리명 : CBBManageConsultMapper.updateCnstgDlvryInfo
     설  명 :  고객사 비율 비율 수정
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <update id="updateCnstgDlvryInfo" parameterType="java.util.HashMap">
        UPDATE /* CBBManageConsultMapper.updateCnstgDlvryInfo */ CP_CNSTG_DLVRY_DTL
        SET
            CMPN_NM = #{dlvryCmpnNm},
            RATE = #{dlvryRate},
            MOD_ID = #{regId},
            MOD_IP = #{regIp},
            MOD_DTM = now()
        WHERE CNSTG_SEQ = #{cnstgSeq}
          AND CMPN_DLVRY_SEQ = #{cmpnDlvrySeq}
    </update>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgDpndnInfo
     설  명 :  완성차 의존 비율 상세 조회
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectCnstgDpndnInfo" parameterType="java.lang.Integer" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectCnstgDpndnInfo */
            CNSTG_SEQ,
            DPNDN_SEQ,
            CMPN_NM as DPNDN_CMPN_NM,
            RATE as DPNDN_RATE
        FROM
            CP_CNSTG_DPNDN_DTL
        WHERE
            CNSTG_SEQ =  #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgAppctnType
     설  명 :  신청 분야 상세
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectCnstgAppctnType" parameterType="java.util.HashMap" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectCmpnCbsnInfoCnt */
            CNSTG_SEQ,
            CD AS APPCTN_TYPE_CD,
            REG_ID,
            REG_IP,
            REG_DTM
        FROM
            CP_CNSTG_APPCTN_TYPE_DTL
        WHERE 1=1
          AND CNSTG_SEQ = #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectTechGuidanceRsume
     설  명 : 컨설팅 진행 사항
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
-->
    <select id="selectTechGuidanceRsume" parameterType="CBBManageConsultInsertDTO" resultType="CBBManageConsultUpdateDTO">
        SELECT /* CBBManageConsultMapper.selectTechGuidanceRsume */
            CNSTG_SEQ
             , BFRE_JDGMT_RSLT_CD
             , BFRE_JDGMT_RSLT_CNTN
             , VST_DT
             , VSTR_NM
             , NTRVR_NM
             , INIT_VST_RSLT_CD
             , INIT_VST_OPNN_CNTN
             , CMSSR_SEQ
             , (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = A.CMSSR_SEQ) CMSSR_NAME
             , GUIDE_TYPE_CD
             , GUIDE_PSCND_CD
             , GUIDE_PSCND_DT
             , GUIDE_BGN_DT
             , GUIDE_KICKF_DT
             , XTNSN_CNCL_RSN
             , CNSTG_CMPLTN_SCHDL_DT
             , CNSTG_XTNSN_RSLT_CNT
             , CNSTG_XTNSN_RSLT_MNTH
             , CNSTG_TERM
             , INIT_VST_FILE_SEQ
             , KICKF_FILE_SEQ
             , LVLUP_FILE_SEQ
             , ETC_FILE_SEQ
             , SRV_SEQ
             , (SELECT CD_ID FROM CO_CODE_MST WHERE CD_ID = 'SURVEY_TYPE' AND CD = (SELECT TYPE_CD FROM SV_MST WHERE SRV_SEQ = A.SRV_SEQ)) AS TYPE_NM
             , (SELECT TITL FROM SV_MST WHERE SRV_SEQ = A.SRV_SEQ) AS SRV_NM
             , SRV_STRT_DTM
             , SRV_END_DTM
             , REG_ID
             , REG_IP
             , REG_DTM
        FROM CP_CNSTG_RSUME_MST A
        WHERE CNSTG_SEQ = #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgDpndnInfoCnt
     설  명 :  부품사 업종 카운트
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectCnstgDpndnInfoCnt" parameterType="java.lang.Integer" resultType="java.lang.Integer">
        SELECT /* CBBManageConsultMapper.selectCnstgDpndnInfoCnt */
            COUNT(*)
        FROM
            CP_CNSTG_CBSN_DTL
        WHERE CNSTG_SEQ = #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.insertCnstgDpndnInfo
     설  명 :  완성차 의존 비율 등록
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <insert id="insertCnstgDpndnInfo" parameterType="java.util.HashMap">
        INSERT /* CBBManageConsultMapper.insertCnstgDpndnInfo */ INTO CP_CNSTG_DPNDN_DTL
        (
        CNSTG_SEQ
        , DPNDN_SEQ
        , CMPN_NM
        , RATE
        , REG_ID
        , REG_IP
        , REG_DTM
        )
        VALUES(
        #{cnstgSeq}
        , #{dpndnSeq}
        , #{cmpnNm}
        , #{dpndnRate}
        , #{regId}
        , #{regIp}
        , now()
        )
    </insert>

    <!--
     쿼리명 : CBBManageConsultMapper.insertCnstgPicInfo
     설  명 :  담당 임원 등록
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.12.11   임서화      최초생성
    -->
    <insert id="insertCnstgPicInfo" parameterType="java.util.HashMap">
        INSERT /* CBBManageConsultMapper.insertCnstgPicInfo */ INTO CP_CNSTG_PIC_DTL
        (
        CNSTG_SEQ
        , PIC_SEQ
        , NAME
        , EMAIL
        , DEPT_NM
        , PSTN_NM
        , HP_NO
        , CMPN_TEL_NO
        , REG_ID
        , REG_IP
        , REG_DTM
        )
        VALUES(
        #{cnstgSeq}
        , #{picSeq}
        , #{name}
        , #{email}
        , #{deptNm}
        , #{pstnNm}
        , #{hpNo}
        , #{cmpnTelNo}
        , #{regId}
        , #{regIp}
        , now()
          )
    </insert>

    <!--
     쿼리명 : CBBManageConsultMapper.updateManageConsult
     설  명 :  컨설팅 기술 관리 수정
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <update id="updateManageConsult" parameterType="CBBManageConsultUpdateDTO">
        UPDATE CP_CNSTG_APPCTN_MST  /*CBBManageConsultMapper.updateManageConsult*/
        SET
            APPCTN_MEM_SEQ = #{memSeq},
            RSUME_STTS_CD = #{rsumeSttsCd},
            APPCTN_DT = #{appctnDt},
            APPCTN_FLD_CD = #{appctnFldCd},
            CMPN_SIZE_CD = #{cpSize},
            FRGN_DPNDN_RATE = #{frgnDpndnRate},
            TTL_SLS_PMT = #{ttlSlsPmt},
            DMSTC_SLS_PMT = #{dmstcSlsPmt},
            FRGN_SLS_PMT = #{frgnSlsPmt},
            CAR_PART_SLS_PMT = #{carPartSlsPmt},
            CAR_PART_XCLUD_SLS_PMT = #{carPartXcludSlsPmt},
            CMPN_ADDR_SAME_YN = #{cmpnAddrSameYn},
            FCTRY_ZIPCODE = #{fctryZipcode},
            FCTRY_BSC_ADDR = #{fctryBscAddr},
            FCTRY_DTL_ADDR = #{fctryDtlAddr},
            FIRST_RGNS_CD = #{firstRgnsCd},
            SCND_RGNS_CD = #{scndRgnsCd},
            QLTY_PIC_CNT = #{qltyPicCnt},
            APPCTN_RSN_CD = #{appctnRsnCd},
            RQST_CNTN = #{rqstCntn},
            ITRDC_FILE_SEQ = #{itrdcFileSeq},
            IMPVM_FILE_SEQ = #{impvmFileSeq},
            ADM_MEMO = #{admMemo},
            MOD_DTM = now(),
            MOD_ID = #{regId},
            MOD_IP = #{regIp}
        WHERE
            CNSTG_SEQ = #{cnstgSeq}
    </update>

    <!--
     쿼리명 : CBBManageConsultMapper.insertManageConsultRsume
     설  명 :  컨설팅 진행 마스터
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <insert id="insertManageConsultRsume" parameterType="CBBManageConsultUpdateDTO">
        INSERT /* CBBManageConsultMapper.insertManageConsultRsume */ INTO CP_CNSTG_RSUME_MST(
            CNSTG_SEQ
            , BFRE_JDGMT_RSLT_CD
            , BFRE_JDGMT_RSLT_CNTN
            , CNSTG_CMPLTN_SCHDL_DT
            , VST_DT
            , VSTR_NM
            , NTRVR_NM
            , INIT_VST_RSLT_CD
            , INIT_VST_OPNN_CNTN
            , CMSSR_SEQ
            , CNSTG_KICKF_DT
            , CNSTG_PSCND_DT
            , CNSTG_XTNSN_RSLT_CNT
            , CNSTG_XTNSN_RSLT_MNTH
            , GUIDE_TYPE_CD
            , GUIDE_PSCND_CD
            , GUIDE_PSCND_DT
            , GUIDE_KICKF_DT
            , CNSTG_TERM
            , XTNSN_CNCL_RSN
            , INIT_VST_FILE_SEQ
            , KICKF_FILE_SEQ
            , LVLUP_FILE_SEQ
            , ETC_FILE_SEQ
            , SRV_SEQ
            , SRV_STRT_DTM
            , SRV_END_DTM
            , REG_ID
            , REG_IP
            , REG_DTM
        )
        VALUES(
            #{detailsKey} ,
            #{bfreJdgmtRsltCd},
            #{bfreJdgmtRsltCntn},
            #{cnstgCmpltnSchdlDt},
            #{vstDt},
            #{vstrNm} ,
            #{ntrvrNm} ,
            #{initVstRsltCd} ,
            #{initVstOpnnCntn} ,
            #{cmssrSeq},
            #{guideKickfDt},
            #{cnstgPscndDt},
            #{cnstgXtnsnRsltCnt},
            #{cnstgXtnsnRsltMnth},
            #{guideTypeCd} ,
            #{guidePscndCd} ,
            #{guidePscndDt} ,
            #{guideKickfDt} ,
            #{cnstgTerm} ,
            #{xtnsnCnclRsn} ,
            #{initVstFileSeq} ,
            #{kickfFileSeq} ,
            #{lvlupFileSeq} ,
            #{etcFileSeq},
            #{srvSeq},
            #{srvStrtDtm},
            #{srvEndDtm},
            #{regId},
            #{regIp},
            now()
              )
    </insert>

    <!--
     쿼리명 : CBATechGuidanceMapper.updateManageConsultRsume
     설  명 :  컨설팅 진행 마스터 업데이트
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.20   임서화      최초생성
    -->
    <update id="updateManageConsultRsume" parameterType="CBATechGuidanceUpdateDTO">
        UPDATE /* CBATechGuidanceMapper.updateManageConsultRsume */ CP_CNSTG_RSUME_MST
        SET
            BFRE_JDGMT_RSLT_CD =  #{bfreJdgmtRsltCd},
            BFRE_JDGMT_RSLT_CNTN =  #{bfreJdgmtRsltCntn},
            CNSTG_CMPLTN_SCHDL_DT = #{cnstgCmpltnSchdlDt},
            VST_DT =  #{vstDt},
            VSTR_NM = #{vstrNm},
            NTRVR_NM =  #{ntrvrNm},
            INIT_VST_RSLT_CD = #{initVstRsltCd},
            INIT_VST_OPNN_CNTN = #{initVstOpnnCntn},
            CMSSR_SEQ =  #{cmssrSeq},
            CNSTG_XTNSN_RSLT_CNT = #{cnstgXtnsnRsltCnt},
            CNSTG_XTNSN_RSLT_MNTH = #{cnstgXtnsnRsltMnth},
            GUIDE_TYPE_CD = #{guideTypeCd},
            GUIDE_PSCND_CD =  #{guidePscndCd},
            GUIDE_PSCND_DT =  #{guidePscndDt},
            GUIDE_BGN_DT =  #{guideBgnDt},
            GUIDE_KICKF_DT =  #{guideKickfDt},
            CNSTG_TERM = #{cnstgTerm},
            XTNSN_CNCL_RSN =  #{xtnsnCnclRsn},
            INIT_VST_FILE_SEQ =  #{initVstFileSeq},
            KICKF_FILE_SEQ =  #{kickfFileSeq},
            LVLUP_FILE_SEQ =  #{lvlupFileSeq},
            ETC_FILE_SEQ =  #{etcFileSeq} ,
            SRV_SEQ = #{srvSeq},
            SRV_STRT_DTM = #{srvStrtDtm},
            SRV_END_DTM = #{srvEndDtm},
            MOD_ID =  #{regId},
            MOD_IP =  #{regIp},
            MOD_DTM = NOW()
        WHERE CNSTG_SEQ =  #{cnstgSeq}
    </update>

    <!--
        쿼리명 : CBBManageConsultMapper.selectRsumeTotCnt
        설  명 :  컨설팅 기술 관리 목록 카운트.
        수정일     수정자       수정내용
        ==========   ======    ==============
        2023.11.14   임서화      최초생성
    -->
    <select id="selectRsumeTotCnt" parameterType="CBATechGuidanceInsertDTO" resultType="java.lang.Integer">
        SELECT /*CBBManageConsultMapper.selectRsumeTotCnt*/
            COUNT(*)
        FROM
            CP_CNSTG_RSUME_MST
        WHERE
            CNSTG_SEQ = #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgPicInfo
     설  명 :  담당 임원 상세 조회
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectCnstgPicInfo" parameterType="java.lang.Integer" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectCnstgPicInfo */
            CNSTG_SEQ,
            PIC_SEQ,
            NAME AS PIC_NAME,
            EMAIL AS PIC_EMAIL,
            DEPT_NM AS PIC_DEPT_NM,
            PSTN_NM AS PIC_PSTN_NM,
            HP_NO AS CMSSR_HP_NO,
            CMPN_TEL_NO AS CMSSR_CMPN_TEL_NO
        FROM
            CP_CNSTG_PIC_DTL
        WHERE CNSTG_SEQ = #{cnstgSeq}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.selectCnstgPicInfo
     설  명 :  담당 임원 삭제
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.12.11   임서화      최초생성
    -->
    <delete id="deleteCnstgPicInfo" parameterType="java.lang.Integer">
        DELETE /*CBBManageConsultMapper.deleteCnstgPicInfo*/
        FROM
            CP_CNSTG_PIC_DTL
        WHERE
            CNSTG_SEQ = #{cnstgSeq}
    </delete>

    <!--
      쿼리명 : CBBManageConsultMapper.updateCnstgDpndnInfo
      설  명 :  고객사 비율 비율 수정
       수정일     수정자       수정내용
     ==========   ======    ==============
     2023.11.14   임서화      최초생성
     -->
    <update id="updateCnstgDpndnInfo" parameterType="java.util.HashMap">
        UPDATE /* CBBManageConsultMapper.updateCnstgDpndnInfo */ CP_CNSTG_DPNDN_DTL
        SET
            CMPN_NM = #{cmpnNm},
            RATE = #{dpndnRate},
            MOD_ID = #{regId},
            MOD_IP = #{regIp},
            MOD_DTM = now()
        WHERE CNSTG_SEQ = #{cnstgSeq}
          AND DPNDN_SEQ = #{dpndnSeq}
    </update>

    <!--
     쿼리명 : CBBManageConsultMapper.insertManageConsult
     설  명 :  컨설팅 기술 관리 등록
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <insert id="insertManageConsult" parameterType="CBBManageConsultInsertDTO">
        INSERT /* CBBManageConsultMapper.insertManageConsult */ INTO CP_CNSTG_APPCTN_MST (
            CNSTG_SEQ
            , APPCTN_BSNM_NO
            , APPCTN_MEM_SEQ
            , CNSTG_CD
            , RSUME_STTS_CD
            , APPCTN_DT
            , APPCTN_FLD_CD
            , BSN_YEAR
            , CMPN_SIZE_CD
            , FRGN_DPNDN_RATE
            , TTL_SLS_PMT
            , DMSTC_SLS_PMT
            , FRGN_SLS_PMT
            , CAR_PART_SLS_PMT
            , CAR_PART_XCLUD_SLS_PMT
            , CMPN_ADDR_SAME_YN
            , FCTRY_ZIPCODE
            , FCTRY_BSC_ADDR
            , FCTRY_DTL_ADDR
            , FIRST_RGNS_CD
            , SCND_RGNS_CD
            , HMPGE_URL
            , QLTY_PIC_CNT
            , APPCTN_RSN_CD
            , RQST_CNTN
            , ITRDC_FILE_SEQ
            , IMPVM_FILE_SEQ
            , REG_ID
            , REG_IP
            , REG_DTM
        )
        VALUES (
            #{cnstgSeq}
            , #{bsnmNo}
            , #{memSeq}
            , "CONSULT_GB02"
            , "MNGCNSLT_STATUS01"
            , #{appctnDt}
            , #{appctnFldCd}
            , DATE_FORMAT(#{appctnDt}, '%Y')
            , #{cpSize}
            , #{frgnDpndnRate}
            , #{ttlSlsPmt}
            , #{dmstcSlsPmt}
            , #{frgnSlsPmt}
            , #{carPartSlsPmt}
            , #{carPartXcludSlsPmt}
            , #{cmpnAddrSameYn}
            , #{fctryZipcode}
            , #{fctryBscAddr}
            , #{fctryDtlAddr}
            , #{firstRgnsCd}
            , #{scndRgnsCd}
            , #{hmpgeUrl}
            , #{qltyPicCnt}
            , #{appctnRsnCd}
            , #{rqstCntn}
            , #{itrdcFileSeq}
            , #{impvmFileSeq}
            , #{regId}
            , #{regIp}
            , NOW()
               )
    </insert>

    <!--
     쿼리명 : CBBManageConsultMapper.selectManageConsultDtl
     설  명 :  컨설팅 기술 관리 상세 조회
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
-->
    <select id="selectManageConsultDtl" parameterType="CBBManageConsultInsertDTO" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectManageConsultDtl */
            A.CNSTG_SEQ,
            A.APPCTN_BSNM_NO AS BSNM_NO,
            A.APPCTN_MEM_SEQ,
            A.CNSTG_CD,
            A.RSUME_STTS_CD,
            A.APPCTN_DT,
            A.CMPN_SIZE_CD AS CP_SIZE,
            A.FRGN_DPNDN_RATE,
            A.TTL_SLS_PMT,
            A.DMSTC_SLS_PMT,
            A.FRGN_SLS_PMT,
            A.CAR_PART_SLS_PMT,
            A.CAR_PART_XCLUD_SLS_PMT,
            A.CMPN_ADDR_SAME_YN,
            A.FCTRY_ZIPCODE,
            A.FCTRY_BSC_ADDR,
            A.FCTRY_DTL_ADDR,
            A.HMPGE_URL,
            A.FIRST_RGNS_CD,
            A.SCND_RGNS_CD,
            A.APPCTN_RSN_CD,
            A.QLTY_PIC_CNT,
            A.APPCTN_FLD_CD,
            A.RQST_CNTN,
            A.ITRDC_FILE_SEQ,
            A.IMPVM_FILE_SEQ,
            B.MEM_SEQ,
            B.ID,
            B.NAME,
            B.HP_NO,
            B.EMAIL,
            B.TEL_NO,
            B.DEPT_CD,
            B.DEPT_DTL_NM,
            B.PSTN_CD,
            B.PSTN_NM,
            (SELECT CD FROM CP_CNSTG_CBSN_DTL where cnstg_seq = A.CNSTG_SEQ) CBSN_CD,
            (SELECT ETC_NM FROM CP_CNSTG_CBSN_DTL where cnstg_seq = A.CNSTG_SEQ) ETC_NM,
            (SELECT FILE_SEQ FROM CO_FILE_MST WHERE FILE_SEQ = A.ITRDC_FILE_SEQ ) ITRDC_FILE_SEQ,
            (SELECT FILE_SEQ FROM CO_FILE_MST WHERE FILE_SEQ = A.IMPVM_FILE_SEQ ) IMPVM_FILE_SEQ,
            (SELECT CMPN_NFRML_NM from cp_cmpn_mst where bsnm_no = A.APPCTN_BSNM_NO) AS CMPN_NFRML_NM,
            (SELECT CMPN_CD from cp_cmpn_mst where bsnm_no = A.APPCTN_BSNM_NO) AS CMPN_CD,
            A.ADM_MEMO,
            A.REG_DTM,
            A.REG_ID,
            (SELECT NAME CO_ADM_MST WHERE ID = B.REG_ID) AS REG_NAME,
            A.MOD_DTM,
            A.MOD_ID,
                                        (SELECT NAME CO_ADM_MST WHERE ID = B.MOD_ID) AS MOD_NAME
        FROM
            CP_CNSTG_APPCTN_MST A, CO_MEM_MST B
        WHERE 1=1
          AND A.CNSTG_SEQ = #{detailsKey}
          AND A.APPCTN_BSNM_NO = B.WORK_BSNM_NO
          AND A.APPCTN_MEM_SEQ = B.MEM_SEQ
    </select>


    <!--
         쿼리명 : CBBManageConsultMapper.selectTrsfGuidanceList
         설  명 : 컨설팅 참여 이관 로그
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.11.14   임서화      최초생성
    -->
    <select id="selectTrsfGuidanceList" parameterType="CBBManageConsultInsertDTO" resultType="CBBManageConsultInsertDTO">
        SELECT /* CBBManageConsultMapper.selectTrsfGuidanceList */
            CNSTG_SEQ,
            (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = A.BFRE_MEM_SEQ) BF_NAME,
            (SELECT ID FROM CO_MEM_MST WHERE MEM_SEQ = A.BFRE_MEM_SEQ) BF_ID,
            (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = A.AFTR_MEM_SEQ) AF_NAME,
            (SELECT ID FROM CO_MEM_MST WHERE MEM_SEQ = A.AFTR_MEM_SEQ) AF_ID,
            BFRE_MEM_SEQ,
            AFTR_MEM_SEQ,
            REG_DTM,
            REG_ID,
            (SELECT NAME FROM CO_ADM_MST WHERE ID=A.REG_ID) REG_NAME
        FROM
            CP_CNSTG_APPCTN_TRNSF_DTL A
        WHERE
            CNSTG_SEQ = #{detailsKey}
            LIMIT #{firstIndex}, #{recordCountPerPage}
    </select>

    <!--
         쿼리명 : CBBManageConsultMapper.insertTrsfGuidanceList
         설  명 : 컨설팅 참여 이관 로그
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.11.14   임서화      최초생성
    -->
    <insert id="insertTrsfGuidanceList" parameterType="CBBManageConsultInsertDTO" >
        INSERT /* CBBManageConsultMapper.insertTrsfGuidanceList */ INTO CP_CNSTG_APPCTN_TRNSF_DTL
        ( TRNSF_SEQ,
          CNSTG_SEQ,
          BFRE_MEM_SEQ,
          AFTR_MEM_SEQ,
          REG_ID,
          REG_IP,
          REG_DTM
        )
        VALUES(
                  #{trnsfSeq},
                  #{cnstgSeq},
                  #{bfreMemSeq},
                  #{aftrMemSeq},
                  #{regId},
                  #{regIp},
                  NOW()
              )
    </insert>

    <!--
     쿼리명 : CBBManageConsultMapper.selectTrsfGuidanceCnt
     설  명 :  컨설팅 기술 관리 이관 내역 카운트
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.11.14   임서화      최초생성
    -->
    <select id="selectTrsfGuidanceCnt" parameterType="CBBManageConsultInsertDTO" resultType="java.lang.Integer">
        SELECT /*CBATechGuidanceMapper.selectTrsfGuidanceCnt*/
            COUNT(*)
        FROM
            CP_CNSTG_APPCTN_TRNSF_DTL
        WHERE
            CNSTG_SEQ = #{detailsKey}
    </select>

    <!--
     쿼리명 : CBBManageConsultMapper.deleteManageConsult
     설  명 : 컨설팅사업 경영컨설팅 신청마스터 테이블 삭제
      수정일     수정자       수정내용
    ==========   ======    ==============
    2023.12.14   이옥정       최초생성
-->
    <delete id="deleteManageConsult" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteManageConsult */
        from
        cp_cnstg_appctn_mst
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultRsumeMst
         설  명 : 컨설팅사업 진행마스터 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultRsumeMst" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultRsumeMst */
        from
        cp_cnstg_rsume_mst
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultPicDtl
         설  명 : 컨설팅사업 담당임원 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultPicDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultPicDtl */
        from
        cp_cnstg_pic_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultCbsnDtl
         설  명 : 컨설팅사업 부품사 업종 상세 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultCbsnDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultCbsnDtl */
        from
        cp_cnstg_cbsn_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultDlvryDtl
         설  명 : 컨설팅사업 고객사비율 상세 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultDlvryDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultDlvryDtl */
        from
        cp_cnstg_dlvry_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultDpndnDtl
         설  명 : 컨설팅사업 완성차의존율 상세 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultDpndnDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultDpndnDtl */
        from
        cp_cnstg_dpndn_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultAppctnTypeDtl
         설  명 : 컨설팅사업 신청분야 상세 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultAppctnTypeDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultAppctnTypeDtl */
        from
        cp_cnstg_appctn_type_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultSrvRsltDtl
         설  명 : 컨설팅사업 만족도 결과 상세 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultSrvRsltDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultSrvRsltDtl */
        from
        cp_cnstg_srv_rslt_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

    <!--
         쿼리명 : CBBManageConsultMapper.deleteConsultAppctnTrnsfDtl
         설  명 : 컨설팅사업 참여이관로그 테이블 삭제
          수정일     수정자       수정내용
        ==========   ======    ==============
        2023.12.15   이옥정       최초생성
    -->
    <delete id="deleteConsultAppctnTrnsfDtl" parameterType="CBBManageConsultSearchDTO">
        delete /* CBBManageConsultMapper.deleteConsultAppctnTrnsfDtl */
        from
        cp_cnstg_appctn_trnsf_dtl
        <where>
            <choose>
                <when test="delValueList != null and delValueList.size() > 0">
                    cnstg_seq in
                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">
                        #{delValueList}
                    </foreach>
                </when>
            </choose>
        </where>
    </delete>

</mapper>