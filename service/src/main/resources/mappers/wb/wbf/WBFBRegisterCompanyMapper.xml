<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kap.service.dao.wb.wbf.WBFBRegisterCompanyMapper">

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getRegisterCompanyList
         설  명 : List Data Select
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getRegisterCompanyList" parameterType="WBFBRegisterSearchDTO" resultType="WBFBRegisterSearchDTO">
        SELECT INFO.*,
            (SELECT cd_nm FROM co_code_mst WHERE cd = INFO.rsume_stts_cd) as rsume_stts_cd_nm,
            (SELECT cd_nm FROM co_code_mst WHERE cd = INFO.mng_stts_cd) as mng_stts_cd_nm,
            (SELECT name FROM co_adm_mst WHERE id = INFO.mod_id) as mod_nm
        FROM
        (
            SELECT
                TEMP.*,
                ( SELECT rsume_stts_cd FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as rsume_stts_cd,
                ( SELECT mng_stts_cd FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as mng_stts_cd,
                ( SELECT appctn_stts_chng_dtm FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as appctn_stts_chng_dtm,
                ( SELECT mng_stts_chng_dtm FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as mng_stts_chng_dtm,
                ( SELECT mod_id FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as mod_id,
                ( SELECT mod_dtm FROM cx_appctn_rsume_dtl card WHERE card.appctn_seq = TEMP.appctn_seq AND card.rsume_ord = TEMP.rsume_ord) as mod_dtm
            FROM
            (
                SELECT /*WBFBRegisterCompanyMapper.getRegisterCompanyList*/
                    YEAR(A.year) as year, A.episd as episd,
                    B.appctn_seq, B.episd_seq, B.sbrdn_bsnm_no, B.reg_id, B.reg_dtm, B.pmndv_pmt_yn,
                    C.*,
                    (SELECT cd_nm FROM co_code_mst WHERE cd = C.ctgry_cd) as ctgry_cd_nm,
                    (SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(C.SIZE_CD,'')) as size_cd_nm,
                    (SELECT MAX(rsume_ord) FROM cx_appctn_rsume_dtl WHERE appctn_seq = B.appctn_seq) as rsume_ord
                FROM
                (
                    SELECT * FROM cx_episd_mst
                    WHERE bsn_cd = #{bsnCd}
                ) A INNER JOIN cx_appctn_mst B ON B.episd_seq = A.episd_seq
                INNER JOIN
                (
                    SELECT a.mem_seq, a.name, a.id, a.hp_no, a.tel_no, a.email, a.pstn_cd, a.pstn_nm
                    , b.cmpn_nm, b.ctgry_cd, b.size_cd, b.bsnm_no
                    ,(SELECT cd_nm FROM co_code_mst WHERE cd = a.pstn_cd) as pstn_cd_nm
                    FROM co_mem_mst a INNER JOIN cp_cmpn_mst b ON a.work_bsnm_no = b.bsnm_no
                ) C /* 회원-회사 JOIN 테이블 */
                ON C.mem_seq = B.mem_seq
            ) TEMP
        ) INFO
        <include refid="selectListwhereSql" />
        ORDER BY episd_seq DESC, appctn_seq DESC
        <if test="excelYn != 'Y'.toString() ">
            LIMIT #{firstIndex}, #{recordCountPerPage}
        </if>
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getRegisterCompanyCount
         설  명 : List Data Count
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getRegisterCompanyCount" parameterType="WBFBRegisterSearchDTO" resultType="java.lang.Integer">
        SELECT /*WBFBRegisterCompanyMapper.getRegisterCompanyList*/
            count(*)
        FROM
            (
            SELECT * FROM cx_episd_mst
            WHERE bsn_cd = #{bsnCd}
        ) A INNER JOIN cx_appctn_mst B ON B.episd_seq = A.episd_seq
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getRegisterDtl
         설  명 : 상생 수정페이지 상세 Data Select
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getRegisterDtl" parameterType="WBFBRegisterSearchDTO" resultType="WBFBRegisterDTO">
        SELECT /*WBFBRegisterCompanyMapper.getRegisterDtl*/
            A.*
            ,B.mem_seq, B.id, B.name, B.email, B.dept_cd, B.dept_dtl_nm, B.pstn_cd, B.pstn_nm, B.hp_no, B.tel_no, B.work_bsnm_no
            ,C.bsnm_no,C.cmpn_nm, C.rprsnt_nm, C.ctgry_cd, C.size_cd, C.bsnm_no, C.stbsm_dt, C.zipcode, C.bsc_addr, C.dtl_addr, C.sls_pmt, C.qlty_5_star_cd, C.pay_5_star_cd, C.tchlg_5_star_cd,C.mple_cnt,C.mjr_prdct_1,C.mjr_prdct_2,C.mjr_prdct_3
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = C.ctgry_cd) ctgry_cd_nm /* 구분 */
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(C.SIZE_CD,'')) size_cd_nm /* 규모 */
            ,C.tel_no as comp_tel /* 회사 전화번호 */
            ,YEAR(C.qlty_5_star_year) as qlty_5_star_year
            ,YEAR(C.pay_5_star_year) as pay_5_star_year
            ,YEAR(C.tchlg_5_star_year) as tchlg_5_star_year
            ,YEAR(C.sls_year) as sls_year
            ,(SELECT task_cd FROM cx_appctn_rsume_task_dtl WHERE rsume_seq = (SELECT rsume_seq FROM cx_appctn_rsume_dtl WHERE appctn_seq = #{appctnSeq} AND rsume_ord = 1)) as task_cd
            ,(SELECT bsn_type_cd FROM cx_appctn_rsume_task_dtl WHERE rsume_seq = (SELECT rsume_seq FROM cx_appctn_rsume_dtl WHERE appctn_seq = #{appctnSeq} AND rsume_ord = 1)) as bsn_type_cd
            ,(SELECT smtfn_prsnt_cd FROM cx_appctn_rsume_task_dtl WHERE rsume_seq = (SELECT rsume_seq FROM cx_appctn_rsume_dtl WHERE appctn_seq = #{appctnSeq} AND rsume_ord = 1)) as smtfn_prsnt_cd
            ,(SELECT smtfn_trgt_cd FROM cx_appctn_rsume_task_dtl WHERE rsume_seq = (SELECT rsume_seq FROM cx_appctn_rsume_dtl WHERE appctn_seq = #{appctnSeq} AND rsume_ord = 1)) as smtfn_trgt_cd
            ,(SELECT name FROM cp_isttr_mst WHERE isttr_seq = A.pic_cmssr_seq) as pic_cmssr_nm
            ,(SELECT email FROM cp_isttr_mst WHERE isttr_seq = A.pic_cmssr_seq) as pic_cmssr_email
            ,(SELECT hp_no FROM cp_isttr_mst WHERE isttr_seq = A.pic_cmssr_seq) as pic_cmssr_hp_no
            ,(SELECT ffltn_nm FROM cp_isttr_mst WHERE isttr_seq = A.pic_cmssr_seq) as pic_cmssr_cmpn_nm
        FROM
            (
                SELECT a.*, YEAR(b.year) as year, b.episd
                FROM (
                    SELECT
                        appctn_seq, episd_seq, mem_seq, appctn_bsnm_no, pic_cmssr_seq, sbrdn_bsnm_no, pmndv_pmt_yn, adm_memo, adm_memo_mod_dtm
                    FROM cx_appctn_mst
                    WHERE appctn_seq = #{appctnSeq}
                ) a
                INNER JOIN cx_episd_mst b ON b.episd_seq = a.episd_seq
            ) A
        INNER JOIN co_mem_mst B ON B.mem_seq = A.mem_seq
        INNER JOIN cp_cmpn_mst C ON C.bsnm_no = B.work_bsnm_no
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getCompanyInfo
         설  명 : 부품사 정보 get
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.24  김동현     최초 생성
    -->
    <select id="getCompanyInfo" parameterType="WBFBRegisterSearchDTO" resultType="WBFBRegisterDTO">
        SELECT /* WBFBRegisterCompanyMapper.getCompanyInfo */
            A.BSNM_NO
             , A.CMPN_NM
             , A.RPRSNT_NM
             , A.CTGRY_CD
             , (SELECT cd_nm FROM co_code_mst WHERE cd = CTGRY_CD) AS CTGRY_CD_NM
             , A.SIZE_CD
             , (SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(SIZE_CD,'')) AS SIZE_CD_NM
             , A.STBSM_DT
             , A.TEL_NO AS COMP_TEL
             , A.ZIPCODE
             , A.BSC_ADDR
             , A.DTL_ADDR
             , A.SLS_PMT
             , A.SLS_YEAR
             , A.MPLE_CNT
             , A.MJR_PRDCT_1
             , A.MJR_PRDCT_2
             , A.MJR_PRDCT_3
             , A.QLTY_5_STAR_CD
             , (SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(A.QLTY_5_STAR_CD,'')) AS QLTY_5_STAR_CD_NM
             , A.QLTY_5_STAR_YEAR
             , A.PAY_5_STAR_CD
             , (SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(A.PAY_5_STAR_CD,'')) AS PAY_5_STAR_CD_NM
             , A.PAY_5_STAR_YEAR
             , A.TCHLG_5_STAR_CD
             , (SELECT cd_nm FROM co_code_mst WHERE cd = NULLIF(A.TCHLG_5_STAR_CD,'')) AS TCHLG_5_STAR_CD_NM
             , A.TCHLG_5_STAR_YEAR
             , (SELECT ID FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) ID
             , (SELECT NAME FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) NAME
             , (SELECT EMAIL FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) EMAIL
             , (SELECT DEPT_CD FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) DEPT_CD
             , (SELECT DEPT_DTL_NM FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) DEPT_DTL_NM
             , (SELECT PSTN_CD FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) PSTN_CD
             , (SELECT PSTN_NM FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) PSTN_NM
             , (SELECT HP_NO FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) HP_NO
             , (SELECT TEL_NO FROM CO_MEM_MST WHERE MEM_SEQ = #{memSeq}) TEL_NO
        FROM CP_CMPN_MST A
        WHERE A.BSNM_NO = #{bsnmNo}
    </select>

    <!--
         쿼리명 : WBFASmartRoundMapper.selectGiveList
         설  명 : 부품사 상세 옵션 지급차수 조회
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getGiveList" parameterType="WBFBRegisterSearchDTO" >
        SELECT /* WBFASmartRoundMapper.selectGiveList */
            give_seq
             ,episd_seq
             ,give_ord
             ,strt_dt
             ,end_dt
        FROM cx_episd_give_dtl
        WHERE EPISD_SEQ = (SELECT episd_seq FROM cx_appctn_mst WHERE appctn_seq = #{appctnSeq})
        ORDER BY GIVE_SEQ ASC
    </select>

    <!--
         쿼리명 : WBFASmartRoundMapper.getBsnmNoCheck
         설  명 : 부품사 상세 옵션 지급차수 조회
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getBsnmNoCheck" parameterType="WBFBRegisterSearchDTO" >
        SELECT /*WBFASmartRoundMapper.getBsnmNoCheck*/
            COUNT(*) as cmpn_count
            , bsnm_no
            , cmpn_nm
            , rprsnt_nm
            , ctgry_cd
        FROM cp_cmpn_mst
        WHERE bsnm_no = #{bsnmNo}
    </select>

    <!--
         쿼리명 : WBPartCompanyMapper.selPartCompanyUserListCnt
         설  명 : 부품사 회원 회사 SQ 정보
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getRegisterDtlSQ" parameterType="WBFBRegisterSearchDTO">
        SELECT cbsn_seq, nm, score, YEAR(year) as year, crtfn_cmpn_nm
        FROM cp_cmpn_cbsn_dtl
        WHERE bsnm_no = #{bsnmNo}
        ORDER BY cbsn_seq;
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getSpprtDtlList
         설  명 : List Data Select Sub - 상생 진행 상세
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getSpprtDtlList" parameterType="WBFBRegisterSearchDTO" >
        SELECT INFO.* /*WBFBRegisterCompanyMapper.getSpprtDtlList*/
            ,(SELECT give_ord FROM cx_episd_give_dtl WHERE give_seq = INFO.give_seq) as give_ord
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = INFO.appctn_stts_cd) as appctn_stts_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = INFO.mng_stts_cd) as mng_stts_cd_nm
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.spprt_appctn_file_seq AND A.use_yn ='Y') as spprt_appctn_file_nm
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.acnt_file_seq AND A.use_yn ='Y') as acnt_file_nm
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.bnkbk_file_seq AND A.use_yn ='Y') as bnkbk_file_nm
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.tchlg_lse_file_seq AND A.use_yn ='Y') as tchlg_lse_file_nm
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.lse_pay_file_seq AND A.use_yn ='Y') as lse_pay_file_nm
            ,DATE_FORMAT(INFO.accs_dt, '%m/%d') AS accs_dt_fmt
            ,DATE_FORMAT(INFO.give_dt, '%m/%d') AS give_dt_fmt
        FROM(
            SELECT
                appctn_spprt_seq,appctn_seq,give_type,accs_dt,gvmnt_spprt_pmt,mjcmn_aprnc_pmt,cmssn_pmt,ttl_pmt,bank_nm,acnt_no
                ,dpsit_nm, appctn_stts_cd,appctn_stts_chng_dtm,give_dt,give_seq,mng_stts_cd,mng_stts_chng_dtm,spprt_appctn_file_seq,acnt_file_seq,bnkbk_file_seq
                ,tchlg_lse_file_seq, lse_pay_file_seq
            FROM cx_appctn_spprt_dtl
            WHERE appctn_seq = #{appctnSeq}
        ) INFO
        ORDER BY appctn_spprt_seq ASC
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getRsumeTaskDtlList
         설  명 : List Data Select Sub - 상생 진행 상세
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getRsumeTaskDtlList" parameterType="WBFBRegisterSearchDTO" >
        SELECT /*WBFBRegisterCompanyMapper.getRsumeTaskDtlList*/
            A.*
            ,B.task_cd,B.bsn_type_cd,B.smtfn_prsnt_cd,B.smtfn_trgt_cd,B.aprnc_cmpn_cd,B.offer_cmpn_nm,B.offer_bsnm_no,B.offer_pic_nm,B.offer_pic_hp_no,B.offer_pic_email
            ,B.ttl_bsn_pmt,B.task_no,B.chk_cmssr_seq,B.chk_plan_dt,B.chk_implmn_dt,B.exam_score,B.smtfn_lvl_chk_cd,B.prmcst_clcltn_instt,B.rqst_dt,B.rply_dt
            ,B.gvmnt_spprt_pmt,B.mjcmn_aprnc_pmt,B.ntdcn_cmpn_brdn_pmt,B.ttl_pmt,B.ttl_bsn_pmt,B.agrmt_dt,B.agrmt_term_dt,B.pmndv_pmt_yn,B.accs_dt,B.bank_nm,B.acnt_no,B.dpsit_nm,B.give_dt,B.give_seq,B.cmssn_pmt, B.cmpltn_brfng_dtm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = A.rsume_stts_cd) as rsume_stts_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = A.appctn_stts_cd) as appctn_stts_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = A.mng_stts_cd) as mng_stts_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = B.task_cd) as task_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = B.bsn_type_cd) as bsn_type_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = B.smtfn_prsnt_cd) as smtfn_prsnt_cd_nm
            ,(SELECT cd_nm FROM co_code_mst WHERE cd = B.smtfn_trgt_cd) as smtfn_trgt_cd_nm
            ,(SELECT name FROM cp_isttr_mst WHERE isttr_seq = B.chk_cmssr_seq) as chk_cmssr_nm
            ,DATE_FORMAT(B.chk_plan_dt, '%m/%d') AS chk_plan_dt_fmt
            ,DATE_FORMAT(B.chk_implmn_dt, '%m/%d') AS chk_implmn_dt_fmt
            ,DATE_FORMAT(B.rqst_dt, '%m/%d') AS rqst_dt_fmt
            ,DATE_FORMAT(B.rply_dt, '%m/%d') AS rply_dt_fmt
            ,DATE_FORMAT(B.agrmt_dt, '%m/%d') AS agrmt_dt_fmt
            ,DATE_FORMAT(B.agrmt_term_dt, '%m/%d') AS agrmt_term_dt_fmt
        FROM (
            SELECT rsume_seq, rsume_ord, rsume_stts_cd, appctn_stts_cd, appctn_stts_chng_dtm
             ,mng_stts_cd, rtrn_rsn_cntn, mng_stts_chng_dtm, mod_id, DATE_FORMAT(mod_dtm, '%Y-%m-%d %H:%i') AS mod_dtm
            FROM cx_appctn_rsume_dtl
            WHERE appctn_seq = #{appctnSeq}
        )A
        LEFT JOIN cx_appctn_rsume_task_dtl B
        ON B.rsume_seq = A.rsume_seq
        ORDER BY A.rsume_ord ASC
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getRsumeTaskDtlFileList
         설  명 : 상생진행상세 - 스마트상세 첨부파일 정보 Select
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getDtlFileList" parameterType="WBFBRsumeTaskDtlDTO">
        SELECT
            *
            ,(SELECT file_ord FROM co_file_dtl A WHERE A.file_seq = INFO.file_seq AND A.use_yn ='Y') as file_ord
            ,(SELECT orgn_file_nm FROM co_file_dtl A WHERE A.file_seq = INFO.file_seq AND A.use_yn ='Y') as orgn_file_nm
        FROM (
            SELECT /*WBFBRegisterCompanyMapper.getRsumeTaskDtlFileList*/
               rsume_seq
               ,rsume_ord
               ,file_cd
               ,file_seq
            FROM cx_appctn_rsume_file_dtl
            WHERE rsume_seq = #{rsumeSeq}
        ) INFO;
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getOptYearList
         설  명 : 연도 Option 검색
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getOptYearList" parameterType="WBFBRegisterSearchDTO">
        SELECT DISTINCT YEAR(year) /*WBFBRegisterCompanyMapper.getOptYearList*/
        FROM cx_episd_mst
        WHERE bsn_cd = #{bsnCd}
        ORDER BY year ASC
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getOptEpisdList
         설  명 : 연도 값 기준 회차 Option 검색
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getOptEpisdList" parameterType="WBFBRegisterSearchDTO">
        SELECT DISTINCT episd /*WBFBRegisterCompanyMapper.getOptEpisdList*/
        FROM cx_episd_mst
        WHERE bsn_cd = #{bsnCd}
        AND year = #{year}
        ORDER BY episd_seq ASC
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.selRoundYear
         설  명 : 연도/회차의 사업 Option 검색
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getOptnList" parameterType="WBFBRegisterSearchDTO" resultType="WBRoundOptnMstDTO">
        SELECT bsn_optn_seq, optn_cd, optn_nm, optn_ord /*WBFBRegisterCompanyMapper.selRoundYear*/
        FROM cx_episd_bsn_optn_dtl
        WHERE episd_seq = #{episdSeq}
        AND optn_cd = #{optnCd}
        ORDER BY optn_cd, optn_ord;
    </select>


    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getEpisdSeq
         설  명 : 연도 Option 검색
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getEpisdSeq" parameterType="WBFBRegisterSearchDTO" resultType="java.lang.Integer">
        SELECT episd_seq
        FROM cx_episd_mst
        WHERE bsn_cd = #{bsnCd}
        AND year = #{year}
        AND episd = #{episd}
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnMst
         설  명 : 회차신청 마스터 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putAppctnMst" parameterType="wBFBRegisterDTO" >
        INSERT /* WBFBRegisterCompanyMapper.putAppctnMst */ INTO cx_appctn_mst
        (
            appctn_seq,
            episd_seq,
            mem_seq,
            appctn_bsnm_no,
            sbrdn_bsnm_no,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
        (
            #{appctnSeq},
            #{episdSeq},
            #{memSeq},
            #{bsnmNo},
            #{sbrdnBsnmNo},
            #{regId},
            #{regIp},
            now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnFileDtl
         설  명 : 회차신청 마스터 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putAppctnFileDtl" parameterType="WBRsumeFileDtlDTO" >
        INSERT /* WBFBRegisterCompanyMapper.putAppctnFileDtl */ INTO cx_appctn_rsume_file_dtl
        (
            rsume_seq,
            rsume_ord,
            file_cd,
            file_seq,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
        (
            #{rsumeSeq},
            #{rsumeOrd},
            #{fileCd},
            #{fileSeq},
            #{regId},
            #{regIp},
            now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnFileDtl
         설  명 : 회차신청 마스터 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnFileDtl" parameterType="wBFBRegisterDTO" >
        DELETE FROM cx_appctn_rsume_file_dtl
        WHERE rsume_seq = #{rsumeSeq} AND rsume_ord = #{rsumeOrd}
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnSpprtDtl
         설  명 : 회차신청 상세 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putAppctnSpprtDtl" parameterType="wBFBRegisterDTO" >
        INSERT /* WBFBRegisterCompanyMapper.putAppctnSpprtDtl */ INTO cx_appctn_spprt_dtl
        (
            appctn_spprt_seq,
            appctn_seq,
            give_type,
            appctn_stts_cd,
            mng_stts_cd,
            mng_stts_chng_dtm,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
        (
            #{appctnSpprtSeq},
            #{appctnSeq},
            #{giveType},
            #{appctnSttsCd},
            #{mngSttsCd},
            now(),
            #{regId},
            #{regIp},
            now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnRsumeDtl
         설  명 : 회차신청 상세 Insert - 등록시
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putAppctnRsumeDtl" parameterType="wBFBRegisterDTO" >
        INSERT /* WBFBRegisterCompanyMapper.putAppctnRsumeDtl */ INTO cx_appctn_rsume_dtl
        (
            rsume_seq,
            rsume_ord,
            appctn_seq,
            rsume_stts_cd,
            appctn_stts_cd,
            <if test='siteGubun == "front"'>appctn_stts_chng_dtm,</if>
            mng_stts_cd,
            <if test='siteGubun == "admin"'>mng_stts_chng_dtm,</if>
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
            (
                #{rsumeSeq},
                #{rsumeOrd},
                #{appctnSeq},
                #{rsumeSttsCd},
                #{appctnSttsCd},
                <if test='siteGubun == "front"'>now(),</if>
                #{mngSttsCd},
                <if test='siteGubun == "admin"'>now(),</if>
                #{regId},
                #{regIp},
                now()
            )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putStepAppctnRsumeDtl
         설  명 : 회차신청 상세 Insert - 단계 진행시
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putStepAppctnRsumeDtl" parameterType="wBFBRegisterDTO" >
        INSERT /* WBFBRegisterCompanyMapper.putStepAppctnRsumeDtl */ INTO cx_appctn_rsume_dtl
        (
            rsume_seq,
            rsume_ord,
            appctn_seq,
            rsume_stts_cd,
            appctn_stts_cd,
            mng_stts_cd,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
            (
                #{rsumeSeq},
                #{rsumeOrd},
                #{appctnSeq},
                #{rsumeSttsCd},
                #{appctnSttsCd},
                #{mngSttsCd},
                #{regId},
                #{regIp},
                now()
            )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.putAppctnRsumeTaskDtl
         설  명 : 회차신청 스마트 상세 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="putAppctnRsumeTaskDtl" parameterType="wBFBRegisterDTO"  >
        INSERT /* WBFBRegisterCompanyMapper.putAppctnRsumeTaskDtl */ INTO cx_appctn_rsume_task_dtl
        (
            rsume_seq,
            rsume_ord,
            task_cd,
            bsn_type_cd,
            smtfn_prsnt_cd,
            smtfn_trgt_cd,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
        (
            #{rsumeSeq},
            #{rsumeOrd},
            #{taskCd},
            #{bsnTypeCd},
            #{smtfnPrsntCd},
            #{smtfnTrgtCd},
            #{regId},
            #{regIp},
            now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updCmpnCbsnMst
         설  명 : 회사 마스터 Update
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updCmpnCbsnMst" parameterType="WBFBRegisterDTO">
        UPDATE /* WBFBRegisterCompanyMapper.updCmpnCbsnMst */ cp_cmpn_mst
        SET
            ctgry_cd = #{ctgryCd}
            ,size_cd = #{sizeCd}
            ,stbsm_dt = #{stbsmDt}
            ,tel_no = #{compTel}
            ,zipcode = #{zipcode}
            ,bsc_addr = #{bscAddr}
            ,dtl_addr = #{dtlAddr}
            ,sls_pmt = #{slsPmt}
            <if test="slsYear != null and slsYear != ''.toString() ">,sls_year = #{slsYear}</if>
            <if test="slsYear == null or slsYear == ''.toString() ">,sls_year = NULL</if>
            <if test="mpleCnt != null and mpleCnt != ''.toString() ">,mple_cnt = #{mpleCnt}</if>
            <if test="mpleCnt == null or mpleCnt == ''.toString() ">,mple_cnt = NULL</if>
            ,mjr_prdct_1 = #{mjrPrdct1}
            ,mjr_prdct_2 = #{mjrPrdct2}
            ,mjr_prdct_3 = #{mjrPrdct3}
            ,qlty_5_star_cd = #{qlty5starCd}
            <if test="qlty5starYear != null and qlty5starYear != ''.toString() ">,qlty_5_star_year = #{qlty5starYear}</if>
            <if test="qlty5starYear == null or qlty5starYear == ''.toString() ">,qlty_5_star_year = NULL</if>
            ,pay_5_star_cd = #{pay5starCd}
            <if test="pay5starYear != null and pay5starYear != ''.toString() ">,pay_5_star_year = #{pay5starYear}</if>
            <if test="pay5starYear == null or pay5starYear == ''.toString() ">,pay_5_star_year = NULL</if>
            ,tchlg_5_star_cd = #{tchlg5starCd}
            <if test="tchlg5starYear != null and tchlg5starYear != ''.toString() ">,tchlg_5_star_year = #{tchlg5starYear}</if>
            <if test="tchlg5starYear == null or tchlg5starYear == ''.toString() ">,tchlg_5_star_year = NULL</if>
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE bsnm_no = #{bsnmNo}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updCoMemMst
         설  명 : 회원 마스터 Update
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updCoMemMst" parameterType="wBFBRegisterDTO">
        UPDATE /*WBFBRegisterCompanyMapper.updCoMemMst*/ co_mem_mst
        SET
            tel_no = #{telNo}
            ,dept_cd = #{deptCd}
            ,dept_dtl_nm = #{deptDtlNm}
            ,pstn_cd = #{pstnCd}
            ,pstn_nm = #{pstnNm}
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE mem_seq = #{memSeq}
        AND id = #{id}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updCmpnCbsnDtl
         설  명 : 회사 상세 Update
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updCmpnCbsnDtl" parameterType="WBCompanyDetailMstDTO">
        UPDATE /* WBFBRegisterCompanyMapper.updCmpnCbsnDtl */ cp_cmpn_cbsn_dtl
        SET
            nm = #{nm}
            ,score = #{score}
            ,year = #{year}
            ,crtfn_cmpn_nm = #{crtfnCmpnNm}
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE bsnm_no = #{bsnmNo}
        AND cbsn_seq = #{cbsnSeq}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.insCmpnCbsnDtl
         설  명 : 회사 상세 Insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="insCmpnCbsnDtl" parameterType="WBCompanyDetailMstDTO">
        INSERT /* WBFBRegisterCompanyMapper.insCmpnCbsnDtl */ cp_cmpn_cbsn_dtl
        (
            bsnm_no,
            cbsn_seq,
            nm,
            score,
            year,
            crtfn_cmpn_nm,
            reg_id,
            reg_ip,
            reg_dtm
        )
        VALUES
        (
            #{bsnmNo},
            #{cbsnSeq},
            #{nm},
            #{score},
            #{year},
            #{crtfnCmpnNm},
            #{regId},
            #{regIp},
            now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updSpprtDtl
         설  명 : 상생신청지원금상세 수정 - 선급금지급
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updSpprtDtl" parameterType="WBSpprtDtlDTO">
        UPDATE cx_appctn_spprt_dtl /*WBFBRegisterCompanyMapper.updSpprtDtl*/
        SET
        <if test='siteGubun == "front"'>
            accs_dt = #{accsDt}
            ,appctn_stts_cd = #{appctnSttsCd}
            ,appctn_stts_chng_dtm = now()
            ,mng_stts_cd = #{mngSttsCd}
            ,gvmnt_spprt_pmt = #{gvmntSpprtPmt}
            ,mjcmn_aprnc_pmt = #{mjcmnAprncPmt}
            ,ttl_pmt = #{ttlPmt}
            ,bank_nm = #{bankNm}
            ,acnt_no = #{acntNo}
            ,dpsit_nm = #{dpsitNm}
            ,spprt_appctn_file_seq = #{spprtAppctnFileSeq}
            ,acnt_file_seq = #{acntFileSeq}
            ,bnkbk_file_seq = #{bnkbkFileSeq}
            ,tchlg_lse_file_seq =#{tchlgLseFileSeq}
            ,lse_pay_file_seq = #{lsePayFileSeq}
            ,cmssn_pmt = #{cmssnPmt}
        </if>
        <if test='siteGubun == "admin"'>
            accs_dt = #{accsDt}
            ,gvmnt_spprt_pmt = #{gvmntSpprtPmt}
            ,mjcmn_aprnc_pmt = #{mjcmnAprncPmt}
            ,ttl_pmt = #{ttlPmt}
            ,bank_nm = #{bankNm}
            ,acnt_no = #{acntNo}
            ,dpsit_nm = #{dpsitNm}
            ,appctn_stts_cd = #{appctnSttsCd}
            ,give_dt = #{giveDt}
            ,give_seq = #{giveSeq}
            ,mng_stts_cd = #{mngSttsCd}
            ,mng_stts_chng_dtm = now()
            ,spprt_appctn_file_seq = #{spprtAppctnFileSeq}
            ,acnt_file_seq = #{acntFileSeq}
            ,bnkbk_file_seq = #{bnkbkFileSeq}
            ,tchlg_lse_file_seq =#{tchlgLseFileSeq}
            ,lse_pay_file_seq = #{lsePayFileSeq}
            ,cmssn_pmt = #{cmssnPmt}
        </if>
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE appctn_spprt_seq = #{appctnSpprtSeq}
        AND appctn_seq = #{appctnSeq}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updRsumeDtl
         설  명 : 상생신청진행상세 수정
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updRsumeDtl" parameterType="WBFBRsumeTaskDtlDTO">
        UPDATE cx_appctn_rsume_dtl /*WBFBRegisterCompanyMapper.updRsumeDtl*/
        SET
            appctn_stts_cd = #{appctnSttsCd}
            ,mng_stts_cd = #{mngSttsCd}
            <if test='siteGubun == "front"'>
                ,appctn_stts_chng_dtm = now()
            </if>
            <if test='siteGubun == "admin"'>
                ,mng_stts_chng_dtm = now()
                ,rtrn_rsn_cntn = #{rtrnRsnCntn}
            </if>
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE rsume_seq = #{rsumeSeq}
        AND rsume_ord = #{rsumeOrd}
        AND appctn_seq = #{appctnSeq}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updAppctnMst
         설  명 : 상생신청진행상세 수정
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updAppctnMst" parameterType="WBFBRegisterDTO">
        UPDATE cx_appctn_mst /*WBFBRegisterCompanyMapper.updAppctnMst*/
        SET
            mem_seq = #{memSeq}
            ,pic_cmssr_seq = #{picCmssrSeq}
            ,sbrdn_bsnm_no = #{sbrdnBsnmNo}
            ,pmndv_pmt_yn = #{pmndvPmtYn}
            ,adm_memo = #{admMemo}
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE appctn_seq = #{appctnSeq}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updAppctnMst
         설  명 : 상생신청진행상세 수정
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updAdmMemo" parameterType="WBFBRegisterDTO">
        UPDATE cx_appctn_mst /*WBFBRegisterCompanyMapper.updAppctnMst*/
        SET
            adm_memo = #{admMemo}
            ,adm_memo_mod_dtm = now()
        WHERE appctn_seq = #{appctnSeq}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updRsumeTaskDtl
         설  명 : 상생신청진행스마트상세 수정
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updRsumeTaskDtl" parameterType="WBFBRsumeTaskDtlDTO">
        UPDATE cx_appctn_rsume_task_dtl /*WBFBRegisterCompanyMapper.updRsumeTaskDtl*/
        SET
        <if test='siteGubun == "front"'>
            offer_cmpn_nm = #{offerCmpnNm}
            ,offer_bsnm_no = #{offerBsnmNo}
            ,offer_pic_nm = #{offerPicNm}
            ,offer_pic_hp_no = #{offerPicHpNo}
            ,offer_pic_email = #{offerPicEmail}
            ,ttl_bsn_pmt = #{ttlBsnPmt}
        </if>
        <if test='siteGubun == "admin"'>
            aprnc_cmpn_cd = #{aprncCmpnCd}
            ,offer_cmpn_nm = #{offerCmpnNm}
            ,offer_bsnm_no = #{offerBsnmNo}
            ,offer_pic_nm = #{offerPicNm}
            ,offer_pic_hp_no = #{offerPicHpNo}
            ,offer_pic_email = #{offerPicEmail}
            ,ttl_bsn_pmt = #{ttlBsnPmt}
            ,task_no = #{taskNo}
            ,chk_cmssr_seq = #{chkCmssrSeq}
            ,chk_plan_dt = #{chkPlanDt}
            ,chk_implmn_dt = #{chkImplmnDt}
            ,exam_score = #{examScore}
            ,prmcst_clcltn_instt = #{prmcstClcltnInstt}
            ,rqst_dt = #{rqstDt}
            ,rply_dt = #{rplyDt}
            ,gvmnt_spprt_pmt = #{gvmntSpprtPmt}
            ,mjcmn_aprnc_pmt = #{mjcmnAprncPmt}
            ,ntdcn_cmpn_brdn_pmt = #{ntdcnCmpnBrdnPmt}
            ,ttl_pmt = #{ttlPmt}
            ,agrmt_dt = #{agrmtDt}
            ,agrmt_term_dt = #{agrmtTermDt}
            ,cmpltn_brfng_dtm = #{cmpltnBrfngDtm}
            ,smtfn_lvl_chk_cd = #{smtfnLvlChkCd}
        </if>
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE rsume_seq = #{rsumeSeq}
        AND rsume_ord = #{rsumeOrd}
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.updRsumeTaskDtlSub
         설  명 : 상생신청진행스마트상세 수정 Sub
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <update id="updRsumeTaskDtlSub" parameterType="wBFBRegisterDTO">
        UPDATE cx_appctn_rsume_task_dtl /*WBFBRegisterCompanyMapper.updRsumeTaskDtlSub*/
        SET
            task_cd = #{taskCd}
            ,bsn_type_cd = #{bsnTypeCd}
            ,smtfn_prsnt_cd = #{smtfnPrsntCd}
            ,smtfn_trgt_cd = #{smtfnTrgtCd}
            ,mod_id = #{modId}
            ,mod_ip = #{modIp}
            ,mod_dtm = now()
        WHERE rsume_seq = (SELECT rsume_seq FROM cx_appctn_rsume_dtl WHERE appctn_seq = #{appctnSeq} and rsume_ord = 1)
    </update>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.insAppctnTrnsfDtl
         설  명 : 상생 신청자 정보 변경 시 - 상생참여이관로그 insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <insert id="insAppctnTrnsfDtl" parameterType="wBFBRegisterDTO">
        INSERT INTO cx_appctn_trnsf_dtl /*WBFBRegisterCompanyMapper.insAppctnTrnsfDtl*/
        (
            trnsf_seq
            ,appctn_seq
            ,bfre_mem_seq
            ,aftr_mem_seq
            ,reg_id
            ,reg_ip
            ,reg_dtm
        )
        VALUES
        (
            #{trnsfSeq}
            ,#{appctnSeq}
            ,#{bfreMemSeq}
            ,#{aftrMemSeq}
            ,#{regId}
            ,#{regIp}
            ,now()
        )
    </insert>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getAppctnTrnsfDtl
         설  명 : 상생 신청자 정보 변경 시 - 상생참여이관로그 insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getAppctnTrnsfDtl" parameterType="WBFBRegisterSearchDTO">
        SELECT /*WBFBRegisterCompanyMapper.getAppctnTrnsfDtl*/
            trnsf_seq
            ,appctn_seq
            ,bfre_mem_seq
            ,(SELECT id FROM co_mem_mst WHERE mem_seq = bfre_mem_seq) AS bfre_mem_id
            ,(SELECT name FROM co_mem_mst WHERE mem_seq = bfre_mem_seq) AS bfre_mem_nm
            ,aftr_mem_seq
            ,(SELECT id FROM co_mem_mst WHERE mem_seq = aftr_mem_seq) AS aftr_mem_id
            ,(SELECT name FROM co_mem_mst WHERE mem_seq = aftr_mem_seq) AS aftr_mem_nm
            ,reg_id
            ,reg_ip
            ,DATE_FORMAT(reg_dtm, '%Y-%m-%d %H:%i') AS reg_dtm
        FROM cx_appctn_trnsf_dtl
        WHERE appctn_seq = #{appctnSeq}
        ORDER BY trnsf_seq DESC
        LIMIT #{firstIndex}, #{recordCountPerPage}
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getAppctnTrnsfDtl
         설  명 : 상생 신청자 정보 변경 시 - 상생참여이관로그 insert
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="getAppctnTrnsfDtlCnt" parameterType="WBFBRegisterSearchDTO">
        SELECT COUNT(*) /*WBFBRegisterCompanyMapper.getAppctnTrnsfDtlCnt*/
        FROM cx_appctn_trnsf_dtl
        WHERE appctn_seq = #{appctnSeq}
        ORDER BY trnsf_seq DESC
    </select>

    <!-- DELETE -->

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnRsumeFileDtl
         설  명 : 삭제 기준 rsume_seq Select
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="selDelRsumeSeq" parameterType="WBFBRegisterSearchDTO">
        SELECT rsume_seq AS delMarkRsumeSeq
        FROM cx_appctn_rsume_dtl
        WHERE appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnRsumeFileDtl
         설  명 : 상생신청파일진행상세 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnRsumeFileDtl" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnRsumeFileDtl*/
        FROM cx_appctn_rsume_file_dtl
        WHERE rsume_seq IN (
            SELECT rsume_seq
            FROM cx_appctn_rsume_dtl
            WHERE appctn_seq IN
            <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
                #{item}
            </foreach>
        )
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnRsumeTaskDtl
         설  명 : 상생신청진행스마트상세 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnRsumeTaskDtl" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnRsumeTaskDtl*/
        FROM cx_appctn_rsume_task_dtl
        WHERE rsume_seq IN (
            SELECT rsume_seq
            FROM cx_appctn_rsume_dtl
            WHERE appctn_seq IN
            <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
                #{item}
            </foreach>
        )
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnTrnsfDtl
         설  명 : 상생참여이관로그 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnTrnsfDtl" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnTrnsfDtl*/
        FROM cx_appctn_trnsf_dtl
        WHERE appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnSpprtDtl
         설  명 : 상생신청파일진행상세 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnSpprtDtl" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnSpprtDtl*/
        FROM cx_appctn_spprt_dtl
        WHERE appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnRsumeDtl
         설  명 : 상생신청진행상세 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnRsumeDtl" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnRsumeDtl*/
        FROM cx_appctn_rsume_dtl
        WHERE appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.delAppctnMst
         설  명 : 상생신청마스터 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <delete id="delAppctnMst" parameterType="WBFBRegisterDTO">
        DELETE /*WBFBRegisterCompanyMapper.delAppctnMst*/
        FROM cx_appctn_mst
        WHERE appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.confDeleteRegister
         설  명 : 상생신청마스터 Delete
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <select id="confDeleteRegister" parameterType="WBFBRegisterDTO">
        SELECT COUNT(*)
        FROM cx_appctn_rsume_dtl
        WHERE rsume_stts_cd = 'PRO_TYPE02001'
        AND (appctn_stts_cd != 'PRO_TYPE02001_01_001' OR mng_stts_cd != 'PRO_TYPE02001_02_001')
        AND appctn_seq IN
        <foreach collection="delValueList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <!--
        쿼리명 : WBFBRegisterCompanyMapper.getSbrdmNoCheck
        설  명 : 상생신청 종된사업장번호 확인
        수정일     수정자     수정내용
       ==========  ======  ==============
       2023.11.16  김동현     최초 생성
       2024.02.29  구은희     신청자 취소 조건 추가
   -->
    <select id="getSbrdmNoCheck" parameterType="WBFBRegisterSearchDTO">
        SELECT /*WBFBRegisterCompanyMapper.getSbrdmNoCheck*/
            COUNT(*)
        FROM cx_appctn_mst A
        LEFT JOIN CX_APPCTN_RSUME_DTL B
        ON A.appctn_seq = B.appctn_seq
        WHERE A.episd_seq = #{episdSeq}
          AND appctn_bsnm_no = #{bsnmNo}
          AND sbrdn_bsnm_no = #{sbrdnBsnmNo}
          AND appctn_stts_cd != 'PRO_TYPE02001_01_004'
          AND mng_stts_cd != 'PRO_TYPE02001_01_004'
    </select>

    <!--
        쿼리명 : WBFBRegisterCompanyMapper.getMemSeqCheck
        설  명 : 상생신청 회원 순번 조회
        수정일     수정자     수정내용
       ==========  ======  ==============
       2023.11.16  김동현     최초 생성
       2024.02.29  구은희     신청자 취소 조건 추가
   -->
    <select id="getMemSeqCheck" parameterType="WBFBRegisterSearchDTO">
        SELECT /*WBFBRegisterCompanyMapper.getMemSeqCheck*/
            COUNT(*)
        FROM cx_appctn_mst A
        LEFT JOIN CX_APPCTN_RSUME_DTL B
        ON A.appctn_seq = B.appctn_seq
        WHERE A.episd_seq = #{episdSeq}
          AND A.mem_seq = #{memSeq}
          AND appctn_bsnm_no = #{bsnmNo}
          AND sbrdn_bsnm_no = #{sbrdnBsnmNo}
          AND appctn_stts_cd != 'PRO_TYPE02001_01_004'
          AND mng_stts_cd != 'PRO_TYPE02001_01_004'
    </select>

    <!--
         쿼리명 : WBBBCompanyMapper.getApplyDtl
         설  명 : 상생 신청자 정보조회
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.24  김동현     최초 생성
    -->
    <select id="getApplyDtl" parameterType="WBFBRegisterSearchDTO" resultType="WBFBRegisterSearchDTO">
        SELECT /* WBFBRegisterCompanyMapper.getApplyDtl */
            A.APPCTN_SEQ,
            EPISD_SEQ,
            MEM_SEQ,
            APPCTN_BSNM_NO,
            A.REG_DTM
        FROM CX_APPCTN_MST A
        JOIN cx_appctn_rsume_dtl B ON A.appctn_seq = B.appctn_seq AND B.rsume_ord = 1
        WHERE EPISD_SEQ = #{episdSeq} AND A.APPCTN_SEQ = #{appctnSeq} AND MEM_SEQ = #{memSeq} AND APPCTN_STTS_CD != 'PRO_TYPE02001_01_004'
    </select>

    <!--
         쿼리명 : WBFASmartRoundMapper.selectListwhereSql
         설  명 : 게시판 리스트 검색 옵션
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.16  김동현     최초 생성
    -->
    <sql id="selectListwhereSql">
        <where>
            <if test="srchDate != null and srchDate != ''.toString() ">
                <choose>
                    <when test="srchDate == 1">
                        <if test="strtDt != null and strtDt != ''.toString()">
                            AND DATE(INFO.reg_dtm) <![CDATA[>=]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                        </if>
                        <if test="endDt != null and endDt != ''.toString()">
                            AND DATE(INFO.REG_DTM) <![CDATA[ < ]]> DATE_ADD(str_to_date(#{endDt}, '%Y-%m-%d'), interval 1 day)
                        </if>
                    </when>
                    <when test="srchDate == 2">
                        <if test="strtDt != null and strtDt != ''.toString()">
                            AND DATE(INFO.REG_DTM) <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                        </if>
                        <if test="endDt != null and endDt != ''.toString()">
                            AND DATE(INFO.REG_DTM) <![CDATA[ < ]]> DATE_ADD(str_to_date(#{endDt}, '%Y-%m-%d'), interval 1 day)
                        </if>
                    </when>
                    <when test="srchDate == 3">
                        <if test="strtDt != null and strtDt != ''.toString()">
                            AND DATE(INFO.MOD_DTM) <![CDATA[ > ]]> STR_TO_DATE(#{strtDt}, '%Y-%m-%d')
                        </if>
                        <if test="endDt != null and endDt != ''.toString()">
                            AND DATE(INFO.MOD_DTM) <![CDATA[ < ]]> DATE_ADD(str_to_date(#{endDt}, '%Y-%m-%d'), interval 1 day)
                        </if>
                    </when>
                </choose>
            </if>

            <if test="ctgryCdList != null and ctgryCdList.size() > 0">
                AND (
                <foreach collection="ctgryCdList" item="ctgryCdList" index="index" open="" close="" separator=" or ">
                    INFO.rsume_stts_cd = #{ctgryCdList}
                </foreach>
                )
            </if>

            <if test="pmndvSttsList != null and pmndvSttsList.size() > 0">
                AND PMNDV_PMT_YN = 'Y'
                AND (SELECT MNG_STTS_CD FROM CX_APPCTN_SPPRT_DTL WHERE GIVE_TYPE = 'PRO_TYPE03001' AND APPCTN_SEQ = INFO.APPCTN_SEQ) IN (
                <foreach collection="pmndvSttsList" item="pmndvSttsList" index="index" separator=" , ">
                    #{pmndvSttsList}
                </foreach>
                )
            </if>

            <if test="spprtSttsList != null and spprtSttsList.size() > 0">
                AND (SELECT MNG_STTS_CD FROM CX_APPCTN_SPPRT_DTL WHERE GIVE_TYPE = 'PRO_TYPE03002' AND APPCTN_SEQ = INFO.APPCTN_SEQ) IN (
                <foreach collection="spprtSttsList" item="spprtSttsList" index="index" separator=" , ">
                    #{spprtSttsList}
                </foreach>
                )
            </if>

            <if test="techSttsList != null and techSttsList.size() > 0">
                AND (SELECT MNG_STTS_CD FROM CX_APPCTN_SPPRT_DTL WHERE GIVE_TYPE = 'PRO_TYPE03003' AND APPCTN_SEQ = INFO.APPCTN_SEQ) IN (
                <foreach collection="techSttsList" item="techSttsList" index="index" separator=" , ">
                    #{techSttsList}
                </foreach>
                )
            </if>

            <if test="year != null and year != ''.toString()">
                AND INFO.year = #{year}
            </if>
            <if test="episd != null and episd != ''.toString()">
                AND INFO.episd = #{episd}
            </if>
            <if test="q != null and q != ''.toString() ">
                <choose>
                    <when test="f == 1">
                        AND INFO.cmpn_nm LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <when test="f == 2">
                        AND INFO.bsnm_no LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <when test="f == 3">
                        AND INFO.name LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <when test="f == 4">
                        AND INFO.id LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <when test="f == 5">
                        AND INFO.hp_no LIKE CONCAT('%', #{q}, '%')))
                    </when>
                    <otherwise>
                        AND (
                            INFO.cmpn_nm LIKE CONCAT('%', #{q}, '%')
                            OR
                            INFO.bsnm_no LIKE CONCAT('%', #{q}, '%')
                            OR
                            INFO.name LIKE CONCAT('%', #{q}, '%')
                            OR
                            INFO.id LIKE CONCAT('%', #{q}, '%')
                            OR
                            INFO.hp_no LIKE CONCAT('%', #{q}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
        </where>
    </sql>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getBsnmNoCnt
         설  명 : 사업자번호 매핑 여부 확인
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.08  김대성     최초 생성
    -->
    <select id="getBsnmNoCnt" parameterType="wBFBRegisterDTO" resultType="java.lang.Integer">
        SELECT /* WBFBRegisterCompanyMapper.getBsnmNoCnt*/ COUNT(*)
        FROM CX_APPCTN_MST B
        JOIN CX_APPCTN_RSUME_DTL C ON B.APPCTN_SEQ = C.APPCTN_SEQ
        WHERE EPISD_SEQ = #{episdSeq}
          AND APPCTN_BSNM_NO = #{bsnmNo}
          AND APPCTN_STTS_CD != 'PRO_TYPE02001_01_004'
    </select>

    <!--
         쿼리명 : WBFBRegisterCompanyMapper.getSbrdnBsnmNoCnt
         설  명 : 종된 사업자번호 매핑 여부 확인
         수정일     수정자     수정내용
        ==========  ======  ==============
        2023.11.08  김대성     최초 생성
    -->
    <select id="getSbrdnBsnmNoCnt" parameterType="wBFBRegisterDTO" resultType="java.lang.Integer">
        SELECT /* WBFBRegisterCompanyMapper.getBsnmNoCnt*/ COUNT(*)
        FROM CX_APPCTN_MST B
        JOIN CX_APPCTN_RSUME_DTL C ON B.APPCTN_SEQ = C.APPCTN_SEQ
        WHERE EPISD_SEQ = #{episdSeq}
          AND SBRDN_BSNM_NO = #{sbrdnBsnmNo}
          AND APPCTN_BSNM_NO = #{bsnmNo}
          AND APPCTN_STTS_CD != 'PRO_TYPE02001_01_004'
    </select>

</mapper>



