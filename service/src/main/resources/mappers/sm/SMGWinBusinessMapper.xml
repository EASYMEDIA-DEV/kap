<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.kap.service.dao.sm.SMGWinBusinessMapper">    <!--         쿼리명 : SMGWinBusinessMapper.selectWinBusinessList         설  명 :  상생 사업 관리 목록 조회.          수정일     수정자       수정내용        ==========   ======    ==============        2023.11.14   임서화      최초생성        2023.11.22   장두석      최신화    -->    <select id="selectWinBusinessList" parameterType="SMGWinBusinessDTO" resultType="SMGWinBusinessDTO">        SELECT /* SMGWinBusinessMapper.selectWinBusinessList */            CXSTN_SEQ,            BSN_NM,            REG_ID,            (SELECT NAME FROM CO_ADM_MST WHERE ID = A.REG_ID) AS REG_NAME,            REG_DTM,            MOD_ID,            (SELECT NAME FROM CO_ADM_MST WHERE ID = A.MOD_ID) AS MOD_NAME,            MOD_DTM,            EXPS_YN,            EXPS_ORD        FROM SM_CXSTN_MST A        WHERE 1=1            <include refid="selectWinBusinessListwhereSql" />        LIMIT #{firstIndex}, #{recordCountPerPage}    </select>    <!--         쿼리명 : SMGWinBusinessMapper.selectWinBusinessTotCnt         설  명 :  상생 사업 관리 목록 카운트.          수정일     수정자       수정내용        ==========   ======    ==============        2023.11.14   임서화      최초생성    -->    <select id="selectWinBusinessTotCnt" parameterType="SMGWinBusinessDTO" resultType="java.lang.Integer">        SELECT            count(*)        FROM            SM_CXSTN_MST A        WHERE 1=1            <include refid="selectWinBusinessListwhereSql" />    </select>    <!--         쿼리명 : SMGWinBusinessMapper.selectWinBusinessDtl         설  명 :  상생 사업 관리 상세 조회          수정일     수정자       수정내용        ==========   ======    ==============        2023.11.14   임서화      최초생성        2023.11.22   장두석      최신화    -->    <select id="selectWinBusinessDtl" parameterType="SMGWinBusinessDTO" resultType="SMGWinBusinessDTO">        SELECT /* SMGWinBusinessMapper.selectWinBusinessDtl */           *        FROM            SM_CXSTN_MST A        WHERE 1=1          AND CXSTN_SEQ = #{detailsKey}    </select>    <!--     쿼리명 : SMGWinBusinessMapper.insertWinBusiness     설  명 :  상생 사업 관리 등록      수정일     수정자       수정내용    ==========   ======    ==============    2023.11.14   임서화      최초생성    2023.11.22   장두석      최신화    -->    <insert id="insertWinBusiness" parameterType="SMGWinBusinessDTO">        <selectKey keyProperty="expsOrd" resultType="java.lang.Integer" order="BEFORE">            SELECT IFNULL(MAX(EXPS_ORD), 0) + 1 FROM SM_CXSTN_MST        </selectKey>        INSERT /* SMGWinBusinessMapper.insertWinBusiness */ INTO SM_CXSTN_MST        (         CXSTN_SEQ        , BSN_NM        , DSC        , URL_URL        , FILE_SEQ        , EXPS_YN        , EXPS_ORD        , REG_ID        , REG_IP        , REG_DTM        )        VALUES        (        #{cxstnSeq}        , #{bsnNm}        , #{dsc}        , #{urlUrl}        , #{fileSeq}        , #{expsYn}        , #{expsOrd}        , #{regId}        , #{regIp}        , NOW()        )    </insert>    <!--     쿼리명 : SMGWinBusinessMapper.updateWinBusiness     설  명 :  상생 사업 관리 수정      수정일     수정자       수정내용    ==========   ======    ==============    2023.11.14   임서화      최초생성    2023.11.22   장두석      최신화    -->    <update id="updateWinBusiness" parameterType="SMGWinBusinessDTO">        UPDATE /* SMGWinBusinessMapper.updateWinBusiness */            SM_CXSTN_MST        SET            BSN_NM = #{bsnNm}            , DSC = #{dsc}            , URL_URL = #{urlUrl}            , FILE_SEQ = #{fileSeq}            , EXPS_YN = #{expsYn}            , MOD_ID = #{modId}            , MOD_IP = #{modIp}            , MOD_DTM = NOW()        WHERE 1=1            AND CXSTN_SEQ = #{detailsKey}    </update>    <!--     쿼리명 : SMGWinBusinessMapper.deleteWinBusiness     설  명 :  상생 사업 관리 삭제      수정일     수정자       수정내용    ==========   ======    ==============    2023.11.14   임서화      최초생성    2023.11.22   장두석      최신화    -->    <delete id="deleteWinBusiness" parameterType="SMGWinBusinessDTO">        DELETE /* SMGWinBusinessMapper.deleteWinBusiness */        FROM        SM_CXSTN_MST        <where>            <choose>                <when test="delValueList != null and delValueList.size() > 0">                    CXSTN_SEQ IN                    <foreach collection="delValueList" item="delValueList" index="index" separator=", " open="(" close=")">                        #{delValueList}                    </foreach>                </when>                <otherwise>                    CXSTN_SEQ = #{detailsKey}                </otherwise>            </choose>        </where>    </delete>    <!--     쿼리명 : SMGWinBusinessMapper.updateOrder     설  명 :  상생 사업 관리 정렬 수정      수정일     수정자       수정내용    ==========   ======    ==============    2023.11.14   임서화      최초생성    2023.11.22   장두석      최신화    -->    <update id="updateOrder" parameterType="SMGWinBusinessDTO">        UPDATE /* SMGWinBusinessMapper.updateOrder */ SM_CXSTN_MST        SET            EXPS_ORD = #{expsOrd}          , MOD_ID = #{modId}          , MOD_IP = #{modIp}          , MOD_DTM = NOW()        WHERE 1=1          AND CXSTN_SEQ = #{cxstnSeq}    </update>    <!--     쿼리명 : SMGWinBusinessMapper.selectWinBusinessNewRow     설  명 : 상생 사업 관리 정렬을 위한 row를 조회한다.      수정일     수정자       수정내용    ==========   ======    ==============    2023.11.14   임서화      최초생성    2023.11.22   장두석      최신화-->    <select id="selectWinBusinessNewRow" parameterType="SMGWinBusinessDTO">        SELECT /* SMGWinBusinessMapper.selectWinBusinessNewRow */            CXSTN_SEQ,            EXPS_ORD        FROM            SM_CXSTN_MST        WHERE            EXPS_ORD = (                SELECT                    <if test='sortType == "UP"'>                        MIN(EXPS_ORD)                    </if>                    <if test='sortType == "DOWN"'>                        MAX(EXPS_ORD)                    </if>                FROM                    SM_CXSTN_MST                WHERE                    1=1                    <if test='sortType == "UP"'>                        AND EXPS_ORD <![CDATA[>]]> #{expsOrd}                    </if>                    <if test='sortType == "DOWN"'>                        AND EXPS_ORD <![CDATA[<]]> #{expsOrd}                    </if>            )        LIMIT 1    </select>    <!--		쿼리명 : selectWinBusinesswhereSql		설  명 : 상생사업 관리 where Sql	      수정일      수정자       수정내용        ==========   ========   ==============        2023.11.14    임서화       최초생성        2023.11.22   장두석      최신화    -->    <sql id="selectWinBusinessListwhereSql">        <if test="strtDt != null and strtDt != ''">            <choose>                <when test="srchDate == 1">                    AND REG_DTM <![CDATA[>=]]> DATE_FORMAT(#{strtDt}, '%Y-%m-%d')                </when>                <when test="srchDate == 2">                    AND MOD_DTM <![CDATA[>=]]> DATE_FORMAT(#{strtDt}, '%Y-%m-%d')                </when>            </choose>        </if>        <if test="endDt != null and endDt != ''">            <choose>                <when test="srchDate == 1">                    AND REG_DTM <![CDATA[<]]>  DATE_ADD(DATE_FORMAT(#{endDt}, '%Y-%m-%d'), INTERVAL 1 DAY)                </when>                <when test="srchDate == 2">                    AND MOD_DTM <![CDATA[<]]>  DATE_ADD(DATE_FORMAT(#{endDt}, '%Y-%m-%d'), INTERVAL 1 DAY)                </when>            </choose>        </if>        <if test="expsYnList != null and expsYnList.size() > 0">            AND (            <foreach collection="expsYnList" item="expsYn" index="index" open="" close="" separator=" OR ">                EXPS_YN = #{expsYn}            </foreach>            )        </if>        <if test="q != null and q != ''">            <choose>                <when test="f == 1">                    AND BSN_NM LIKE CONCAT('%', #{q}, '%')                </when>                <when test="f == 2">                    AND (                    INSTR(#{q}, A.REG_ID) <![CDATA[>]]> 0 OR                    EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = A.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)                    )                </when>                <when test="f == 3">                    AND (                    INSTR(#{q}, MOD_ID) <![CDATA[>]]> 0 OR                    EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = A.MOD_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)                    )                </when>                <otherwise>                    AND (                    INSTR(#{q}, BSN_NM) <![CDATA[>]]> 0 OR                    INSTR(#{q}, REG_ID) <![CDATA[>]]> 0 OR                    EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = A.REG_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0) OR                    INSTR(#{q}, MOD_ID) <![CDATA[>]]> 0 OR                    EXISTS(SELECT 'x' FROM CO_ADM_MST WHERE ID = A.MOD_ID AND INSTR(#{q}, NAME) <![CDATA[>]]> 0)                    )                </otherwise>            </choose>        </if>        ORDER BY        EXPS_ORD DESC    </sql></mapper>